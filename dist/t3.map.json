{"version":3,"file":"bundle.js","sources":["/Users/mauricio/Documents/web/maurizzzio.me/T3/node_modules/browserify/node_modules/browser-pack/_prelude.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/src/index.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/src/themes/dark.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/src/lib/OrbitControls.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/src/controller/Application.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/src/model/Coordinates.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/src/themes/light.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/src/controller/Keyboard.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/src/controller/LoopManager.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/src/lib/THREEx/index.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/src/lib/THREEx/WindowResize.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/src/lib/THREEx/FullScreen.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/node_modules/extend/index.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/node_modules/stats-js/build/stats.min.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/node_modules/dat-gui/index.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/node_modules/dat-gui/vendor/dat.color.js","/Users/mauricio/Documents/web/maurizzzio.me/T3/node_modules/dat-gui/vendor/dat.gui.js"],"names":["require","Application","t3","model","Coordinates","themes","dark","light","controller","Keyboard","LoopManager","run","module","exports","clearColor","fogColor","groundColor","gridColor","THREE","OrbitControls","object","domElement","getAutoRotationAngle","Math","PI","scope","autoRotateSpeed","getZoomScale","pow","zoomSpeed","onMouseDown","event","enabled","preventDefault","button","noRotate","state","STATE","ROTATE","rotateStart","set","clientX","clientY","noZoom","DOLLY","dollyStart","noPan","PAN","panStart","document","addEventListener","onMouseMove","onMouseUp","dispatchEvent","startEvent","element","body","rotateEnd","rotateDelta","subVectors","rotateLeft","x","clientWidth","rotateSpeed","rotateUp","y","clientHeight","copy","dollyEnd","dollyDelta","dollyIn","dollyOut","panEnd","panDelta","pan","update","removeEventListener","endEvent","NONE","onMouseWheel","stopPropagation","delta","undefined","wheelDelta","detail","onKeyDown","noKeys","keyCode","keys","UP","keyPanSpeed","BOTTOM","LEFT","RIGHT","touchstart","touches","length","TOUCH_ROTATE","pageX","pageY","TOUCH_DOLLY","dx","dy","distance","sqrt","TOUCH_PAN","touchmove","touchend","this","target","Vector3","center","minDistance","maxDistance","Infinity","autoRotate","minPolarAngle","maxPolarAngle","EPS","Vector2","panOffset","offset","phiDelta","thetaDelta","scale","lastPosition","lastQuaternion","Quaternion","target0","clone","position0","position","quat","setFromUnitVectors","up","quatInverse","inverse","changeEvent","type","angle","panLeft","te","matrix","elements","multiplyScalar","add","panUp","deltaX","deltaY","fov","sub","targetDistance","tan","top","right","left","bottom","console","warn","dollyScale","applyQuaternion","theta","atan2","z","phi","max","min","radius","sin","cos","lookAt","distanceToSquared","dot","quaternion","reset","window","prototype","Object","create","EventDispatcher","config","extend","selector","width","innerWidth","height","innerHeight","renderImmediately","injectCache","fullScreen","theme","helpersConfig","defaultSceneConfig","fog","initialConfig","scenes","activeScene","cameras","activeCamera","renderer","keyboard","datgui","stats","loopManager","__t3cache__","initApplication","call","assert","condition","message","emptyFn","Stats","dat","THREEx","getConfig","me","setTheme","createDefaultRenderer","createDefaultScene","createDefaultCamera","createDefaultLights","initDatGui","initStats","initMask","maskVisible","initFullScreen","initKeyboard","initCoordinates","gameLoop","setActiveScene","key","addScene","scene","Scene","defaultScene","Fog","WebGLRenderer","setClearColor","setSize","querySelector","appendChild","setActiveCamera","addCamera","camera","PerspectiveCamera","OrthographicCamera","defaultCamera","defaults","ratio","near","far","WindowResize","bind","createCameraControls","cameraControls","AmbientLight","cache","DirectionalLight","name","mask","createElement","className","style","background","v","display","gui","GUI","autoPlace","zIndex","FullScreen","available","bindKey","mesh","animate","render","inject","lastObject","lastMethod","Object3D","remove","apply","arguments","getFromCache","options","init","QuickLaunch","axes","drawAllAxes","axisLength","axisRadius","axisTess","visible","ground","drawGround","size","color","gridX","drawGrid","gridY","orientation","gridZ","hasOwnProperty","folder","addFolder","onFinishChange","property","newValue","params","grid","GridHelper","setColors","rotation","Mesh","PlaneGeometry","MeshBasicMaterial","transparent","side","DoubleSide","opacity","drawAxes","axisOrientation","wrap","axisMaterial","MeshLambertMaterial","axis","CylinderGeometry","arrow","axisXMaterial","axisYMaterial","axisZMaterial","axisX","axisY","axisZ","arrowX","arrowY","arrowZ","i","onKeyUp","get","charCodeAt","value","application","clock","Clock","pause","fps","guiControllers","paused","loop","elapsedTime","getDelta","frameRateInS","requestAnimationFrame","start","setValue","stop","windowResize","callback","aspect","updateProjectionMatrix","_hasWebkitFullScreen","_hasMozFullScreen","activated","webkitIsFullScreen","mozFullScreen","request","webkitRequestFullScreen","Element","ALLOW_KEYBOARD_INPUT","mozRequestFullScreen","cancel","webkitCancelFullScreen","mozCancelFullScreen","opts","charCode","dblclick","toggle","__bind","fn","onKeyPress","which","unbind","hasOwn","toString","isPlainObject","obj","has_own_constructor","has_is_property_of_method","constructor","src","copyIsArray","deep","Array","isArray","l","Date","now","m","g","n","o","h","p","q","r","s","f","id","b","t","cssText","a","innerHTML","c","children","j","d","k","e","REVISION","setMode","begin","end","textContent","firstChild","round","utils","common","ARR_EACH","forEach","ARR_SLICE","slice","BREAK","each","isUndefined","compose","toCall","args","itr","defer","fnc","setTimeout","toArray","isNull","isNaN","isObject","isNumber","isString","isBoolean","isFunction","hex","Color","interpret","math","defineRGBComponent","component","componentHexIndex","defineProperty","__state","space","recalculateRGB","defineHSVComponent","recalculateHSV","component_from_hex","hsv_to_rgb","result","rgb_to_hsv","COMPONENTS","toOriginal","conversion","write","rgb_to_hex","toReturn","original","INTERPRETATIONS","family","litmus","conversions","conversionName","read","THREE_CHAR_HEX","test","match","parseInt","SIX_CHAR_HEX","CSS_RGB","parseFloat","CSS_RGBA","HEX","RGB_ARRAY","RGBA_ARRAY","RGBA_OBJ","RGB_OBJ","HSVA_OBJ","HSV_OBJ","tmpComponent","hi","floor","NaN","hex_with_component","componentIndex","controllers","dom","css","load","url","doc","link","rel","href","getElementsByTagName","injected","Controller","initialValue","__onChange","__onFinishChange","onChange","updateDisplay","getValue","isModified","cssValueToPixels","val","CSS_VALUE_PIXELS","EVENT_MAP","HTMLEvents","MouseEvents","KeyboardEvents","EVENT_MAP_INV","makeSelectable","elem","selectable","onselectstart","MozUserSelect","KhtmlUserSelect","unselectable","makeFullscreen","horizontal","vertical","fakeEvent","eventType","aux","Error","evt","createEvent","initMouseEvent","bubbles","cancelable","clickCount","initKeyboardEvent","initKeyEvent","ctrlKey","altKey","shiftKey","metaKey","initEvent","func","bool","attachEvent","detachEvent","addClass","classes","split","indexOf","push","join","replace","removeClass","removeAttribute","index","splice","hasClass","RegExp","getWidth","getComputedStyle","getHeight","getOffset","offsetParent","offsetLeft","offsetTop","isActive","activeElement","OptionController","superclass","_this","__select","map","opt","setAttribute","desiredValue","selectedIndex","NumberController","numDecimals","__min","__max","__step","step","__impliedStep","log","LN10","__precision","NumberControllerBox","roundToDecimal","decimals","tenTo","attempted","__input","onBlur","onMouseDrag","prev_y","diff","__truncationSuspended","blur","NumberControllerSlider","styleSheet","i1","i2","o1","o2","__background","__foreground","useDefaultStyles","pct","FunctionController","text","__button","fire","BooleanController","__prev","__checkbox","checked","saveDialogueContents","controllerFactory","ColorController","CenteredDiv","factoryArgs","concat","before","__li","recallSavedValue","container","li","addRow","CLASS_CONTROLLER_ROW","augmentController","__controllers","liBefore","__ul","insertBefore","onResize","__gui","nextElementSibling","firstElementChild","listen","box","method","pc","pb","returned","borderLeftColor","__color","getRoot","__preset_select","markPresetModified","root","matched_index","__rememberedObjects","controller_map","__rememberedObjectIndecesToControllers","remembered","preset","preset_map","DEFAULT_DEFAULT_PRESET_NAME","getLocalStorageHash","location","addSaveMenu","showHideExplain","explain","useLocalStorage","div","__save_row","gears","button2","button3","select","addPresetOption","SUPPORTS_LOCAL_STORAGE","saveLocally","getElementById","localStorageCheckBox","localStorage","getItem","newConstructorTextArea","SAVE_DIALOGUE","hide","JSON","stringify","getSaveObject","show","focus","save","presetName","prompt","saveAs","revert","addResizeHandle","dragStart","pmouseX","__closeButton","CLASS_DRAG","drag","dragStop","__resize_handle","marginLeft","cursor","setWidth","w","getCurrentPreset","useInitialValues","saved_values","setSelected","setPresetSelectIndex","modified","updateDisplays","controllerArray","auto_place_container","CSS_NAMESPACE","HIDE_KEY_CODE","CLOSE_BUTTON_HEIGHT","auto_place_virgin","hideable_guis","saveToLocalStorage","setItem","resetWidth","__folders","__listening","DEFAULT_WIDTH","resizable","hideable","parent","scrollable","use_local_storage","defineProperties","title_row_name","closed","CLASS_CLOSED","TEXT_OPEN","TEXT_CLOSED","CLASS_MAIN","saved_gui","parse","CLASS_CLOSE_BUTTON","createTextNode","title_row","on_click_title","CLASS_AUTO_PLACE_CONTAINER","CLASS_AUTO_PLACE","toggleHide","CLASS_TOO_TALL","addColor","removeChild","destroy","new_gui_params","folders","open","close","childNodes","node","offsetHeight","remember","factory","StringController","linearGradient","vendors","vendor","hueGradient","fieldDown","setSV","unbindSV","unbindH","setH","__saturation_field","scrollLeft","scrollTop","__hue_field","__temp","__selector","__field_knob","__field_knob_border","__hue_knob","__input_textShadow","value_field","padding","backgroundColor","boxShadow","border","borderRadius","borderRight","marginRight","outline","textAlign","fontWeight","textShadow","mismatch","flip","_flip","marginTop","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","backgroundElement","WebkitTransition","webkitTransform","layout"],"mappings":"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","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","require('./lib/OrbitControls');\n\n/**\n * t3\n * @namespace\n * @type {Object}\n */\nvar Application = require('./controller/Application');\nvar t3 = {\n  model: {\n    Coordinates: require('./model/Coordinates')\n  },\n  themes: {\n    dark: require('./themes/dark'),\n    light: require('./themes/light')\n  },\n  controller: {\n    Application: Application,\n    Keyboard: require('./controller/Keyboard'),\n    LoopManager: require('./controller/LoopManager')\n  },\n  Application: Application,\n\n  // alias\n  run: Application.run\n};\nmodule.exports = t3;","/**\n * @module  themes/dark\n */\n\n/**\n * Dark theme\n * @type {Object}\n */\nmodule.exports = {\n\tclearColor: 0x3f3f3f,\n\tfogColor: 0x3f3f3f,\n  groundColor: 0x333333,\n  gridColor: 0x555555\n};","/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n */\n/*global THREE, console */\n\n// This set of controls performs orbiting, dollying (zooming), and panning. It maintains\n// the \"up\" direction as +Y, unlike the TrackballControls. Touch on tablet and phones is\n// supported.\n//\n//    Orbit - left mouse / touch: one finger move\n//    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\n//    Pan - right mouse, or arrow keys / touch: three finter swipe\n//\n// This is a drop-in replacement for (most) TrackballControls used in examples.\n// That is, include this js file and wherever you see:\n//    \tcontrols = new THREE.TrackballControls( camera );\n//      controls.target.z = 150;\n// Simple substitute \"OrbitControls\" and the control should work as-is.\n\nTHREE.OrbitControls = function ( object, domElement ) {\n\n\tthis.object = object;\n\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\n\n\t// API\n\n\t// Set to false to disable this control\n\tthis.enabled = true;\n\n\t// \"target\" sets the location of focus, where the control orbits around\n\t// and where it pans with respect to.\n\tthis.target = new THREE.Vector3();\n\n\t// center is old, deprecated; use \"target\" instead\n\tthis.center = this.target;\n\n\t// This option actually enables dollying in and out; left as \"zoom\" for\n\t// backwards compatibility\n\tthis.noZoom = false;\n\tthis.zoomSpeed = 1.0;\n\n\t// Limits to how far you can dolly in and out\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\t// Set to true to disable this control\n\tthis.noRotate = false;\n\tthis.rotateSpeed = 1.0;\n\n\t// Set to true to disable this control\n\tthis.noPan = false;\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t// Set to true to automatically rotate around the target\n\tthis.autoRotate = false;\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n\t// How far you can orbit vertically, upper and lower limits.\n\t// Range is 0 to Math.PI radians.\n\tthis.minPolarAngle = 0; // radians\n\tthis.maxPolarAngle = Math.PI; // radians\n\n\t// Set to true to disable use of the keys\n\tthis.noKeys = false;\n\n\t// The four arrow keys\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n\t////////////\n\t// internals\n\n\tvar scope = this;\n\n\tvar EPS = 0.000001;\n\n\tvar rotateStart = new THREE.Vector2();\n\tvar rotateEnd = new THREE.Vector2();\n\tvar rotateDelta = new THREE.Vector2();\n\n\tvar panStart = new THREE.Vector2();\n\tvar panEnd = new THREE.Vector2();\n\tvar panDelta = new THREE.Vector2();\n\tvar panOffset = new THREE.Vector3();\n\n\tvar offset = new THREE.Vector3();\n\n\tvar dollyStart = new THREE.Vector2();\n\tvar dollyEnd = new THREE.Vector2();\n\tvar dollyDelta = new THREE.Vector2();\n\n\tvar phiDelta = 0;\n\tvar thetaDelta = 0;\n\tvar scale = 1;\n\tvar pan = new THREE.Vector3();\n\n\tvar lastPosition = new THREE.Vector3();\n\tvar lastQuaternion = new THREE.Quaternion();\n\n\tvar STATE = { NONE : -1, ROTATE : 0, DOLLY : 1, PAN : 2, TOUCH_ROTATE : 3, TOUCH_DOLLY : 4, TOUCH_PAN : 5 };\n\n\tvar state = STATE.NONE;\n\n\t// for reset\n\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\n\t// so camera.up is the orbit axis\n\n\tvar quat = new THREE.Quaternion().setFromUnitVectors( object.up, new THREE.Vector3( 0, 1, 0 ) );\n\tvar quatInverse = quat.clone().inverse();\n\n\t// events\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start'};\n\tvar endEvent = { type: 'end'};\n\n\tthis.rotateLeft = function ( angle ) {\n\n\t\tif ( angle === undefined ) {\n\n\t\t\tangle = getAutoRotationAngle();\n\n\t\t}\n\n\t\tthetaDelta -= angle;\n\n\t};\n\n\tthis.rotateUp = function ( angle ) {\n\n\t\tif ( angle === undefined ) {\n\n\t\t\tangle = getAutoRotationAngle();\n\n\t\t}\n\n\t\tphiDelta -= angle;\n\n\t};\n\n\t// pass in distance in world space to move left\n\tthis.panLeft = function ( distance ) {\n\n\t\tvar te = this.object.matrix.elements;\n\n\t\t// get X column of matrix\n\t\tpanOffset.set( te[ 0 ], te[ 1 ], te[ 2 ] );\n\t\tpanOffset.multiplyScalar( - distance );\n\t\t\n\t\tpan.add( panOffset );\n\n\t};\n\n\t// pass in distance in world space to move up\n\tthis.panUp = function ( distance ) {\n\n\t\tvar te = this.object.matrix.elements;\n\n\t\t// get Y column of matrix\n\t\tpanOffset.set( te[ 4 ], te[ 5 ], te[ 6 ] );\n\t\tpanOffset.multiplyScalar( distance );\n\t\t\n\t\tpan.add( panOffset );\n\n\t};\n\t\n\t// pass in x,y of change desired in pixel space,\n\t// right and down are positive\n\tthis.pan = function ( deltaX, deltaY ) {\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\tif ( scope.object.fov !== undefined ) {\n\n\t\t\t// perspective\n\t\t\tvar position = scope.object.position;\n\t\t\tvar offset = position.clone().sub( scope.target );\n\t\t\tvar targetDistance = offset.length();\n\n\t\t\t// half of the fov is center to top of screen\n\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t// we actually don't use screenWidth, since perspective camera is fixed to screen height\n\t\t\tscope.panLeft( 2 * deltaX * targetDistance / element.clientHeight );\n\t\t\tscope.panUp( 2 * deltaY * targetDistance / element.clientHeight );\n\n\t\t} else if ( scope.object.top !== undefined ) {\n\n\t\t\t// orthographic\n\t\t\tscope.panLeft( deltaX * (scope.object.right - scope.object.left) / element.clientWidth );\n\t\t\tscope.panUp( deltaY * (scope.object.top - scope.object.bottom) / element.clientHeight );\n\n\t\t} else {\n\n\t\t\t// camera neither orthographic or perspective\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\n\t\t}\n\n\t};\n\n\tthis.dollyIn = function ( dollyScale ) {\n\n\t\tif ( dollyScale === undefined ) {\n\n\t\t\tdollyScale = getZoomScale();\n\n\t\t}\n\n\t\tscale /= dollyScale;\n\n\t};\n\n\tthis.dollyOut = function ( dollyScale ) {\n\n\t\tif ( dollyScale === undefined ) {\n\n\t\t\tdollyScale = getZoomScale();\n\n\t\t}\n\n\t\tscale *= dollyScale;\n\n\t};\n\n\tthis.update = function () {\n\n\t\tvar position = this.object.position;\n\n\t\toffset.copy( position ).sub( this.target );\n\n\t\t// rotate offset to \"y-axis-is-up\" space\n\t\toffset.applyQuaternion( quat );\n\n\t\t// angle from z-axis around y-axis\n\n\t\tvar theta = Math.atan2( offset.x, offset.z );\n\n\t\t// angle from y-axis\n\n\t\tvar phi = Math.atan2( Math.sqrt( offset.x * offset.x + offset.z * offset.z ), offset.y );\n\n\t\tif ( this.autoRotate ) {\n\n\t\t\tthis.rotateLeft( getAutoRotationAngle() );\n\n\t\t}\n\n\t\ttheta += thetaDelta;\n\t\tphi += phiDelta;\n\n\t\t// restrict phi to be between desired limits\n\t\tphi = Math.max( this.minPolarAngle, Math.min( this.maxPolarAngle, phi ) );\n\n\t\t// restrict phi to be betwee EPS and PI-EPS\n\t\tphi = Math.max( EPS, Math.min( Math.PI - EPS, phi ) );\n\n\t\tvar radius = offset.length() * scale;\n\n\t\t// restrict radius to be between desired limits\n\t\tradius = Math.max( this.minDistance, Math.min( this.maxDistance, radius ) );\n\t\t\n\t\t// move target to panned location\n\t\tthis.target.add( pan );\n\n\t\toffset.x = radius * Math.sin( phi ) * Math.sin( theta );\n\t\toffset.y = radius * Math.cos( phi );\n\t\toffset.z = radius * Math.sin( phi ) * Math.cos( theta );\n\n\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\toffset.applyQuaternion( quatInverse );\n\n\t\tposition.copy( this.target ).add( offset );\n\n\t\tthis.object.lookAt( this.target );\n\n\t\tthetaDelta = 0;\n\t\tphiDelta = 0;\n\t\tscale = 1;\n\t\tpan.set( 0, 0, 0 );\n\n\t\t// update condition is:\n\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\tif ( lastPosition.distanceToSquared( this.object.position ) > EPS\n\t\t    || 8 * (1 - lastQuaternion.dot(this.object.quaternion)) > EPS ) {\n\n\t\t\tthis.dispatchEvent( changeEvent );\n\n\t\t\tlastPosition.copy( this.object.position );\n\t\t\tlastQuaternion.copy (this.object.quaternion );\n\n\t\t}\n\n\t};\n\n\n\tthis.reset = function () {\n\n\t\tstate = STATE.NONE;\n\n\t\tthis.target.copy( this.target0 );\n\t\tthis.object.position.copy( this.position0 );\n\n\t\tthis.update();\n\n\t};\n\n\tfunction getAutoRotationAngle() {\n\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t}\n\n\tfunction getZoomScale() {\n\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t}\n\n\tfunction onMouseDown( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\t\tevent.preventDefault();\n\n\t\tif ( event.button === 0 ) {\n\t\t\tif ( scope.noRotate === true ) return;\n\n\t\t\tstate = STATE.ROTATE;\n\n\t\t\trotateStart.set( event.clientX, event.clientY );\n\n\t\t} else if ( event.button === 1 ) {\n\t\t\tif ( scope.noZoom === true ) return;\n\n\t\t\tstate = STATE.DOLLY;\n\n\t\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t\t} else if ( event.button === 2 ) {\n\t\t\tif ( scope.noPan === true ) return;\n\n\t\t\tstate = STATE.PAN;\n\n\t\t\tpanStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\n\t\tscope.dispatchEvent( startEvent );\n\n\t}\n\n\tfunction onMouseMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\tif ( state === STATE.ROTATE ) {\n\n\t\t\tif ( scope.noRotate === true ) return;\n\n\t\t\trotateEnd.set( event.clientX, event.clientY );\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart );\n\n\t\t\t// rotating across whole screen goes 360 degrees around\n\t\t\tscope.rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\n\t\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\t\tscope.rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t} else if ( state === STATE.DOLLY ) {\n\n\t\t\tif ( scope.noZoom === true ) return;\n\n\t\t\tdollyEnd.set( event.clientX, event.clientY );\n\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\t\tscope.dollyIn();\n\n\t\t\t} else {\n\n\t\t\t\tscope.dollyOut();\n\n\t\t\t}\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t} else if ( state === STATE.PAN ) {\n\n\t\t\tif ( scope.noPan === true ) return;\n\n\t\t\tpanEnd.set( event.clientX, event.clientY );\n\t\t\tpanDelta.subVectors( panEnd, panStart );\n\t\t\t\n\t\t\tscope.pan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t}\n\n\t\tscope.update();\n\n\t}\n\n\tfunction onMouseUp( /* event */ ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\t\tscope.dispatchEvent( endEvent );\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onMouseWheel( event ) {\n\n\t\tif ( scope.enabled === false || scope.noZoom === true ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tvar delta = 0;\n\n\t\tif ( event.wheelDelta !== undefined ) { // WebKit / Opera / Explorer 9\n\n\t\t\tdelta = event.wheelDelta;\n\n\t\t} else if ( event.detail !== undefined ) { // Firefox\n\n\t\t\tdelta = - event.detail;\n\n\t\t}\n\n\t\tif ( delta > 0 ) {\n\n\t\t\tscope.dollyOut();\n\n\t\t} else {\n\n\t\t\tscope.dollyIn();\n\n\t\t}\n\n\t\tscope.update();\n\t\tscope.dispatchEvent( startEvent );\n\t\tscope.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction onKeyDown( event ) {\n\n\t\tif ( scope.enabled === false || scope.noKeys === true || scope.noPan === true ) return;\n\t\t\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase scope.keys.UP:\n\t\t\t\tscope.pan( 0, scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\tscope.pan( 0, - scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.LEFT:\n\t\t\t\tscope.pan( scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.RIGHT:\n\t\t\t\tscope.pan( - scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction touchstart( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\t// one-fingered touch: rotate\n\n\t\t\t\tif ( scope.noRotate === true ) return;\n\n\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\t// two-fingered touch: dolly\n\n\t\t\t\tif ( scope.noZoom === true ) return;\n\n\t\t\t\tstate = STATE.TOUCH_DOLLY;\n\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\t\t\t\tdollyStart.set( 0, distance );\n\t\t\t\tbreak;\n\n\t\t\tcase 3: // three-fingered touch: pan\n\n\t\t\t\tif ( scope.noPan === true ) return;\n\n\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\tpanStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tscope.dispatchEvent( startEvent );\n\n\t}\n\n\tfunction touchmove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1: // one-fingered touch: rotate\n\n\t\t\t\tif ( scope.noRotate === true ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_ROTATE ) return;\n\n\t\t\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\trotateDelta.subVectors( rotateEnd, rotateStart );\n\n\t\t\t\t// rotating across whole screen goes 360 degrees around\n\t\t\t\tscope.rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\t\t\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\t\t\tscope.rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n\t\t\t\trotateStart.copy( rotateEnd );\n\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase 2: // two-fingered touch: dolly\n\n\t\t\t\tif ( scope.noZoom === true ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_DOLLY ) return;\n\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\t\tdollyEnd.set( 0, distance );\n\t\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\t\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\t\t\tscope.dollyOut();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tscope.dollyIn();\n\n\t\t\t\t}\n\n\t\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase 3: // three-fingered touch: pan\n\n\t\t\t\tif ( scope.noPan === true ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_PAN ) return;\n\n\t\t\t\tpanEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\tpanDelta.subVectors( panEnd, panStart );\n\t\t\t\t\n\t\t\t\tscope.pan( panDelta.x, panDelta.y );\n\n\t\t\t\tpanStart.copy( panEnd );\n\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t}\n\n\tfunction touchend( /* event */ ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tscope.dispatchEvent( endEvent );\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tthis.domElement.addEventListener( 'contextmenu', function ( event ) { event.preventDefault(); }, false );\n\tthis.domElement.addEventListener( 'mousedown', onMouseDown, false );\n\tthis.domElement.addEventListener( 'mousewheel', onMouseWheel, false );\n\tthis.domElement.addEventListener( 'DOMMouseScroll', onMouseWheel, false ); // firefox\n\n\tthis.domElement.addEventListener( 'touchstart', touchstart, false );\n\tthis.domElement.addEventListener( 'touchend', touchend, false );\n\tthis.domElement.addEventListener( 'touchmove', touchmove, false );\n\n\twindow.addEventListener( 'keydown', onKeyDown, false );\n\n\t// force an update at start\n\tthis.update();\n\n};\n\nTHREE.OrbitControls.prototype = Object.create( THREE.EventDispatcher.prototype );\n","'use strict';\n\nvar assert = function (condition, message) {\n  if (!condition) {\n    throw message || 'assertion failed';\n  }\n};\n\nvar emptyFn = function () {};\nvar extend = require('extend');\nvar Stats = require('stats-js');\nvar dat = require('dat-gui');\nvar THREE = window.THREE;\n\nvar Coordinates = require('../model/Coordinates');\nvar Keyboard = require('./Keyboard');\nvar LoopManager = require('./LoopManager');\nvar THREEx = require('../lib/THREEx/');\n/**\n * @module controller/Application\n */\n\n/**\n * Each instance controls one element of the DOM, besides creating\n * the canvas for the three.js app it creates a dat.gui instance\n * (to control objects of the app with a gui) and a Stats instance\n * (to view the current framerate)\n *\n * @class\n * @param {Object} config An object containing the following:\n * @param {string} [config.id=null] The id of the DOM element to inject the elements to\n * @param {number} [config.width=window.innerWidth]\n * The width of the canvas\n * @param {number} [config.height=window.innerHeight]\n * The height of the canvas\n * @param {boolean} [config.renderImmediately=true]\n * False to disable the game loop when the application starts, if\n * you want to resume the loop call `application.loopManager.start()`\n * @param {boolean} [config.injectCache=false]\n * True to add a wrapper over `THREE.Object3D.prototype.add` and\n * `THREE.Object3D.prototype.remove` so that it catches the last element\n * and perform additional operations over it, with this mechanism\n * we allow the application to have an internal cache of the elements of\n * the application\n * @param {boolean} [config.fullScreen=false]\n * True to make this app fullscreen adding additional support for\n * window resize events\n * @param {string} [config.theme='dark']\n * Theme used in the default scene, it can be `light` or `dark`\n * @param {object} [config.ambientConfig={}]\n * Additional configuration for the ambient, see the class {@link\n * Coordinates}\n * @param {object} [config.defaultSceneConfig={}] Additional config\n * for the default scene created for this world\n */\nfunction Application(config) {\n  config = extend({\n    selector: null,\n    width: window.innerWidth,\n    height: window.innerHeight,\n    renderImmediately: true,\n    injectCache: false,\n    fullScreen: false,\n    theme: 'dark',\n    helpersConfig: {},\n    defaultSceneConfig: {\n      fog: true\n    }\n  }, config);\n\n  this.initialConfig = config;\n\n  /**\n   * Scenes in this world, each scene should be mapped with\n   * a unique id\n   * @type {Object}\n   */\n  this.scenes = {};\n\n  /**\n   * The active scene of this world\n   * @type {THREE.Scene}\n   */\n  this.activeScene = null;\n\n  /**\n   * Reference to the cameras used in this world\n   * @type {Array}\n   */\n  this.cameras = {};\n\n  /**\n   * The world can have many cameras, so the this is a reference to\n   * the active camera that's being used right now\n   * @type {T3.model.Camera}\n   */\n  this.activeCamera = null;\n\n  /**\n   * THREE Renderer\n   * @type {Object}\n   */\n  this.renderer = null;\n\n  /**\n   * Keyboard manager\n   * @type {Object}\n   */\n  this.keyboard = null;\n\n  /**\n   * Dat gui manager\n   * @type {Object}\n   */\n  this.datgui = null;\n\n  /**\n   * Reference to the Stats instance (needed to call update\n   * on the method {@link module:controller/Application#update})\n   * @type {Object}\n   */\n  this.stats = null;\n\n  /**\n   * Reference to the local loop manager\n   * @type {LoopManager}\n   */\n  this.loopManager = null;\n\n  /**\n   * Colors for the default scene\n   * @type {Object}\n   */\n  this.theme = null;\n\n  /**\n   * Application cache\n   * @type {Object}\n   */\n  this.__t3cache__ = {};\n\n  Application.prototype.initApplication.call(this);\n}\n\n/**\n * Getter for the initial config\n * @return {Object}\n */\nApplication.prototype.getConfig = function () {\n  return this.initialConfig;\n};\n\n/**\n * Bootstrap the application with the following steps:\n *\n * - Enabling cache injection\n * - Set the theme\n * - Create the renderer, default scene, default camera, some random lights\n * - Initializes dat.gui, Stats, a mask when the application is paised\n * - Initializes fullScreen events, keyboard and some helper objects\n * - Calls the game loop\n *\n */\nApplication.prototype.initApplication = function () {\n  var me = this,\n    config = me.getConfig();\n\n  me.injectCache(config.injectCache);\n\n  // theme\n  me.setTheme(config.theme);\n\n  // defaults\n  me.createDefaultRenderer();\n  me.createDefaultScene();\n  me.createDefaultCamera();\n  me.createDefaultLights();\n\n  // utils\n  me.initDatGui();\n  me.initStats();\n  me.initMask()\n    .maskVisible(!config.renderImmediately);\n  me.initFullScreen();\n  me.initKeyboard();\n  me.initCoordinates();\n\n  // game loop\n  me.gameLoop();\n};\n\n/**\n * Sets the active scene (it must be a registered scene registered\n * with {@link #addScene})\n * @param {string} key The string which was used to register the scene\n * @return {this}\n */\nApplication.prototype.setActiveScene = function (key) {\n  this.activeScene = this.scenes[key];\n  return this;\n};\n\n/**\n * Adds a scene to the scene pool\n * @param {THREE.Scene} scene\n * @param {string} key\n * @return {this}\n */\nApplication.prototype.addScene = function (scene, key) {\n  console.assert(scene instanceof THREE.Scene);\n  this.scenes[key] = scene;\n  return this;\n};\n\n/**\n * Creates a scene called 'default' and sets it as the active one\n * @return {this}\n */\nApplication.prototype.createDefaultScene = function () {\n  var me = this,\n    config = me.getConfig(),\n    defaultScene = new THREE.Scene();\n  if (config.defaultSceneConfig.fog) {\n    defaultScene.fog = new THREE.Fog(me.theme.fogColor, 2000, 4000);\n  }\n  me\n    .addScene(defaultScene, 'default')\n    .setActiveScene('default');\n  return me;\n};\n\n/**\n * Creates the default THREE.WebGLRenderer used in the world\n * @return {this}\n */\nApplication.prototype.createDefaultRenderer = function () {\n  var me = this,\n    config = me.getConfig();\n  var renderer = new THREE.WebGLRenderer({\n//      antialias: true\n  });\n  renderer.setClearColor(me.theme.clearColor, 1);\n  renderer.setSize(config.width, config.height);\n  document\n    .querySelector(config.selector)\n    .appendChild(renderer.domElement);\n  me.renderer = renderer;\n  return me;\n};\n\nApplication.prototype.setActiveCamera = function (key) {\n  this.activeCamera = this.cameras[key];\n  return this;\n};\n\nApplication.prototype.addCamera = function (camera, key) {\n  console.assert(camera instanceof THREE.PerspectiveCamera ||\n    camera instanceof THREE.OrthographicCamera);\n  this.cameras[key] = camera;\n  return this;\n};\n\n/**\n * Create the default camera used in this world which is\n * a `THREE.PerspectiveCamera`, it also adds orbit controls\n * by calling {@link #createCameraControls}\n */\nApplication.prototype.createDefaultCamera = function () {\n  var me = this,\n    config = me.getConfig(),\n    width = config.width,\n    height = config.height,\n    defaults = {\n      fov: 38,\n      ratio: width / height,\n      near: 1,\n      far: 10000\n    },\n    defaultCamera;\n\n  defaultCamera = new THREE.PerspectiveCamera(\n    defaults.fov,\n    defaults.ratio,\n    defaults.near,\n    defaults.far\n  );\n  defaultCamera.position.set(500, 300, 500);\n\n  // transparently support window resize\n  if (config.fullScreen) {\n    THREEx.WindowResize.bind(me.renderer, defaultCamera);\n  }\n\n  me\n    .createCameraControls(defaultCamera)\n    .addCamera(defaultCamera, 'default')\n    .setActiveCamera('default');\n\n  return me;\n};\n\n/**\n * Creates OrbitControls over the `camera` passed as param\n * @param  {THREE.PerspectiveCamera|THREE.OrtographicCamera} camera\n * @return {this}\n */\nApplication.prototype.createCameraControls = function (camera) {\n  var me = this;\n  camera.cameraControls = new THREE.OrbitControls(\n    camera,\n    me.renderer.domElement\n  );\n  // avoid panning to see the bottom face\n  //camera.cameraControls.maxPolarAngle = Math.PI / 2 * 0.99;\n  //camera.cameraControls.target.set(100, 100, 100);\n  camera.cameraControls.target.set(0, 0, 0);\n  return me;\n};\n\n/**\n * Creates some random lights in the default scene\n * @return {this}\n */\nApplication.prototype.createDefaultLights = function () {\n  var light,\n      scene = this.scenes['default'];\n\n  light = new THREE.AmbientLight(0x222222);\n  scene.add(light).cache('ambient-light-1');\n\n  light = new THREE.DirectionalLight( 0xFFFFFF, 1.0 );\n  light.position.set( 200, 400, 500 );\n  scene.add(light).cache('directional-light-1');\n\n  light = new THREE.DirectionalLight( 0xFFFFFF, 1.0 );\n  light.position.set( -500, 250, -200 );\n  scene.add(light).cache('directional-light-2');\n\n  return this;\n};\n\n/**\n * Sets the theme to be used in the default scene\n * @param {string} name Either the string `dark` or `light`\n * @todo Make the theme system extensible\n * @return {this}\n */\nApplication.prototype.setTheme = function (name) {\n  var me = this,\n    themes = require('../').themes;\n  assert(themes[name]);\n  me.theme = themes[name];\n  return me;\n};\n\n/**\n * Creates a mask on top of the canvas when it's paused\n * @return {this}\n */\nApplication.prototype.initMask = function () {\n  var me = this,\n    config = me.getConfig(),\n    mask,\n    hidden;\n  mask = document.createElement('div');\n  mask.className = 't3-mask';\n  // mask.style.display = 'none';\n  mask.style.position = 'absolute';\n  mask.style.top = '0px';\n  mask.style.width = '100%';\n  mask.style.height = '100%';\n  mask.style.background = 'rgba(0,0,0,0.5)';\n\n  document\n    .querySelector(config.selector)\n    .appendChild(mask);\n\n  me.mask = mask;\n  return me;\n};\n\n/**\n * Updates the mask visibility\n * @param  {boolean} v True to make it visible\n */\nApplication.prototype.maskVisible = function (v) {\n  var mask = this.mask;\n  mask.style.display = v ? 'block' : 'none';\n};\n\n/**\n * Inits the dat.gui helper which is placed under the\n * DOM element identified by the initial configuration selector\n * @return {this}\n */\nApplication.prototype.initDatGui = function () {\n  var me = this,\n    config = me.getConfig(),\n    gui = new dat.GUI({\n      autoPlace: false\n    });\n\n  extend(gui.domElement.style, {\n    position: 'absolute',\n    top: '0px',\n    right: '0px',\n    zIndex: '1'\n  });\n  document\n    .querySelector(config.selector)\n    .appendChild(gui.domElement);\n  me.datgui = gui;\n  return me;\n};\n\n/**\n * Init the Stats helper which is placed under the\n * DOM element identified by the initial configuration selector\n * @return {this}\n */\nApplication.prototype.initStats = function () {\n  var me = this,\n    config = me.getConfig(),\n    stats;\n  // add Stats.js - https://github.com/mrdoob/stats.js\n  stats = new Stats();\n  extend(stats.domElement.style, {\n    position: 'absolute',\n    zIndex: 1,\n    bottom: '0px'\n  });\n  document\n    .querySelector(config.selector)\n    .appendChild( stats.domElement );\n  me.stats = stats;\n  return me;\n};\n\n/**\n * Binds the F key to make a world go full screen\n * @todo This should be used only when the canvas is active\n */\nApplication.prototype.initFullScreen = function () {\n  var config = this.getConfig();\n  // allow 'f' to go fullscreen where this feature is supported\n  if(config.fullScreen && THREEx.FullScreen.available()) {\n    THREEx.FullScreen.bindKey();\n  }\n};\n\n/**\n * Initializes the coordinate helper (its wrapped in a model in T3)\n */\nApplication.prototype.initCoordinates = function () {\n  var config = this.getConfig();\n  this.scenes['default']\n    .add(\n      new Coordinates(config.helpersConfig, this.theme)\n        .initDatGui(this.datgui)\n        .mesh\n    );\n};\n\n/**\n * Initis the keyboard helper\n * @return {this}\n */\nApplication.prototype.initKeyboard = function () {\n  this.keyboard = new Keyboard();\n  return this;\n};\n\n/**\n * Initializes the game loop by creating an instance of {@link LoopManager}\n * @return {this}\n */\nApplication.prototype.gameLoop = function () {\n  var config = this.getConfig();\n  this.loopManager = new LoopManager(this, config.renderImmediately)\n    .initDatGui(this.datgui)\n    .animate();\n  return this;\n};\n\n/**\n * Update phase, the world updates by default:\n *\n * - The stats helper\n * - The camera controls if the active camera has one\n *\n * @param {number} delta The number of seconds elapsed\n */\nApplication.prototype.update = function (delta) {\n  var me = this;\n\n  // stats helper\n  me.stats.update();\n\n  // camera update\n  if (me.activeCamera.cameraControls) {\n    me.activeCamera.cameraControls.update(delta);\n  }\n};\n\n/**\n * Render phase, calls `this.renderer` with `this.activeScene` and\n * `this.activeCamera`\n */\nApplication.prototype.render = function () {\n  var me = this;\n  me.renderer.render(\n    me.activeScene,\n    me.activeCamera\n  );\n};\n\n/**\n * Wraps `THREE.Object3D.prototype.add` and `THREE.Object3D.prototype.remove`\n * with functions that save the last object which `add` or `remove` have been\n * called with, this allows to call the method `cache` which will cache\n * the object with an identifier allowing fast object retrieval\n *\n * @example\n *\n *   var instance = t3.Application.run({\n *     injectCache: true,\n *     init: function () {\n *       var group = new THREE.Object3D();\n *       var innerGroup = new THREE.Object3D();\n *\n *       var geometry = new THREE.BoxGeometry(1,1,1);\n *       var material = new THREE.MeshBasicMaterial({color: 0x00ff00});\n *       var cube = new THREE.Mesh(geometry, material);\n *\n *       innerGroup\n *         .add(cube)\n *         .cache('myCube');\n *\n *       group\n *         .add(innerGroup)\n *         .cache('innerGroup');\n *\n *       // removal example\n *       // group\n *       //   .remove(innerGroup)\n *       //   .cache();\n *\n *       this.activeScene\n *         .add(group)\n *         .cache('group');\n *     },\n *\n *     update: function (delta) {\n *       var cube = this.getFromCache('myCube');\n *       // perform operations on the cube\n *     }\n *   });\n *\n * @param  {boolean} inject True to enable this behavior\n */\nApplication.prototype.injectCache = function (inject) {\n  var me = this,\n      lastObject,\n      lastMethod,\n      add = THREE.Object3D.prototype.add,\n      remove = THREE.Object3D.prototype.remove,\n      cache = this.__t3cache__;\n\n  if (inject) {\n    THREE.Object3D.prototype.add = function (object) {\n      lastMethod = 'add';\n      lastObject = object;\n      return add.apply(this, arguments);\n    };\n\n    THREE.Object3D.prototype.remove = function (object) {\n      lastMethod = 'remove';\n      lastObject = object;\n      return remove.apply(this, arguments);\n    };\n\n    THREE.Object3D.prototype.cache = function (name) {\n      assert(lastObject, 'T3.Application.prototype.cache: this method' +\n        ' needs a previous call to add/remove');\n      if (lastMethod === 'add') {\n        lastObject.name = lastObject.name || name;\n        assert(lastObject.name);\n        cache[lastObject.name] = lastObject;\n      } else {\n        assert(lastObject.name);\n        delete cache[lastObject.name];\n      }\n      lastObject = null;\n      return me;\n    };\n  } else {\n    THREE.Object3D.prototype.cache = function () {\n      return this;\n    };\n  }\n};\n\n/**\n * Gets an object from the cache if `injectCache` was enabled and\n * an object was registered with {@link #cache}\n * @param  {string} name\n * @return {THREE.Object3D}\n */\nApplication.prototype.getFromCache = function (name) {\n  return this.__t3cache__[name];\n};\n\n/**\n * @static\n * Creates a subclass of Application whose instances don't need to\n * worry about the inheritance process\n * @param  {Object} options The same object passed to the {@link Application}\n * constructor\n * @param {Object} options.init Initialization phase, function called in\n * the constructor of the subclass\n * @param {Object} options.update Update phase, function called as the\n * update function of the subclass, it also calls Application's update\n * @return {t3.QuickLaunch} An instance of the subclass created in\n * this function\n */\nApplication.run = function (options) {\n  options.init = options.init || emptyFn;\n  options.update = options.update || emptyFn;\n  assert(options.selector, 'canvas selector required');\n\n  var QuickLaunch = function (options) {\n    Application.call(this, options);\n    options.init.call(this, options);\n  };\n  QuickLaunch.prototype = Object.create(Application.prototype);\n\n  QuickLaunch.prototype.update = function (delta) {\n    Application.prototype.update.call(this, delta);\n    options.update.call(this, delta);\n  };\n\n  return new QuickLaunch(options);\n};\n\nmodule.exports = Application;","var THREE = window.THREE;\n\n/**\n * @module  model/Coordinates\n */\n\n/**\n * Coordinates helper, it creates the axes, ground and grids\n * shown in the world\n * @class\n * @param {Object} config\n * @param {Object} theme\n */\nfunction Coordinates(config, theme) {\n  config = config || {};\n\n  /**\n   * Group where all the objects (axes, ground, grids) are put\n   * @type {THREE.Object3D}\n   */\n  this.mesh = new THREE.Object3D();\n\n  /**\n   * Axes object, the mesh representing the axes is under this object \n   * under `mesh`\n   * @type {Object}\n   */\n  this.axes = {\n    name: 'Axes',\n    mesh: this.drawAllAxes({axisLength:100,axisRadius:1,axisTess:50}),\n    visible: config.axes !== undefined ? config.axes : true\n  };\n\n  /**\n   * Ground object, the mesh representing the axes is under this object\n   * under `mesh`\n   * @type {Object}\n   */\n  this.ground = {\n    name: 'Ground',\n    mesh: this.drawGround({size:100000, color: theme.groundColor}),\n    visible: config.ground !== undefined ? config.ground : true\n  };\n  \n  /**\n   * GridXZ object, the mesh representing the axes is under this object\n   * under `mesh`\n   * @type {Object}\n   */\n  this.gridX = {\n    name: 'XZ grid',\n    mesh: this.drawGrid({size:10000, scale:0.01, color: theme.gridColor}),\n    visible: config.gridX !== undefined ? config.gridX : true\n  };\n\n  /**\n   * GridYZ object, the mesh representing the axes is under this object\n   * under `mesh`\n   * @type {Object}\n   */  \n  this.gridY = {\n    name: 'YZ grid',\n    mesh: this.drawGrid({size:10000, scale:0.01, orientation:\"y\", color: theme.gridColor}),\n    visible: config.gridY !== undefined ? config.gridY : false\n  };\n  \n  /**\n   * GridXY object, the mesh representing the axes is under this object\n   * under `mesh`\n   * @type {Object}\n   */\n  this.gridZ = {\n    name: 'XY grid',\n    mesh: this.drawGrid({size:10000, scale:0.01, orientation:\"z\", color: theme.gridColor}),\n    visible: config.gridZ !== undefined ? config.gridZ : false\n  };\n\n  Coordinates.prototype.init.call(this, config);\n}\n\n/**\n * Adds the axes, ground, grid meshes to `this.mesh`\n * @param  {object} options\n * @return {this}\n */\nCoordinates.prototype.init = function (options) {\n  var me = this;\n  for (var key in me) {\n    if (me.hasOwnProperty(key)) {\n      var v = me[key];\n      if (v.mesh) {\n        me.mesh.add(v.mesh);\n        v.mesh.visible = v.visible;\n      }\n    }\n  }\n\n  return me;\n};\n\n/**\n * Creates a dat.gui folder which has controls for the \n * ground, axes and grids\n * @param  {dat.gui} gui\n * @return {this}\n */\nCoordinates.prototype.initDatGui = function (gui) {\n  var me = this,\n    folder;\n\n  folder = gui.addFolder('Scene helpers');\n  for (var key in me) {\n    if (me.hasOwnProperty(key)) {\n      var v = me[key];\n      if (v.hasOwnProperty('mesh')) {\n        folder.add(v, 'visible')\n          .name(v.name)\n          .onFinishChange((function (property) {\n            return function (newValue) {\n              property.mesh.visible = newValue;\n            };\n          })(v));\n      }\n    }\n  }\n  return me;\n};\n\n/**\n * Draws a grid\n * @param  {object} params\n * @param  {object} params.size=100\n * @param  {object} params.scale=0.1\n * @param  {object} params.color=#505050\n * @param  {object} params.orientation=0.1\n * @return {THREE.Mesh}\n */\nCoordinates.prototype.drawGrid = function (params) {\n  params = params || {};\n  var color = params.color !== undefined ? params.color:'#505050';\n  var orientation = params.orientation !== undefined ? params.orientation:\"x\";\n  var grid = new THREE.GridHelper( 500, 10 );\n  grid.setColors( 0xa8a8a8, color );\n  if (orientation === \"x\") {\n    grid.rotation.x = - Math.PI / 2;\n  } else if (orientation === \"y\") {\n    grid.rotation.y = - Math.PI / 2;\n  } else if (orientation === \"z\") {\n    grid.rotation.z = - Math.PI / 2;\n  }\n  return grid;\n};\n\n/**\n * Draws the ground\n * @param  {object} params\n * @param  {object} params.size=100\n * @param  {object} params.scale=0x000000\n * @param  {object} params.offset=-0.2\n * @return {THREE.Mesh}\n */\nCoordinates.prototype.drawGround = function (params) {\n  params = params || {};\n  var size = params.size !== undefined ? params.size:100;\n  var color = params.color !== undefined ? params.color:0x000000;\n  var offset = params.offset !== undefined ? params.offset:-0.5;\n\n  var ground = new THREE.Mesh(\n    new THREE.PlaneGeometry(size, size),\n    new THREE.MeshBasicMaterial({\n      transparent: true,\n      side: THREE.DoubleSide,\n      opacity: 0.6,\n      color: color\n    })\n  );\n  ground.rotation.x = - Math.PI / 2;\n  ground.position.y = offset;\n  return ground;\n};\n\n/**\n * Draws an axis\n * @param  {object} params\n * @param  {object} params.axisRadius=0.04\n * @param  {object} params.axisLength=11\n * @param  {object} params.axisTess=46\n * @param  {object} params.axisOrientation=x\n * @return {THREE.Mesh}\n */\nCoordinates.prototype.drawAxes = function (params) {\n  // x = red, y = green, z = blue  (RGB = xyz)\n  params = params || {};\n  var axisRadius = params.axisRadius !== undefined ? params.axisRadius:0.04;\n  var axisLength = params.axisLength !== undefined ? params.axisLength:11;\n  var axisTess = params.axisTess !== undefined ? params.axisTess:48;\n  var axisOrientation = params.axisOrientation !== undefined ? params.axisOrientation:\"x\";\n\n  var wrap = new THREE.Object3D();\n  var axisMaterial = new THREE.MeshLambertMaterial({ color: 0x000000, side: THREE.DoubleSide });\n  var axis = new THREE.Mesh(\n    new THREE.CylinderGeometry(axisRadius, axisRadius, axisLength, axisTess, 1, true), \n    axisMaterial\n  );\n  if (axisOrientation === \"x\") {\n    axis.rotation.z = - Math.PI / 2;\n    axis.position.x = axisLength/2-1;\n  } else if (axisOrientation === \"y\") {\n    axis.position.y = axisLength/2-1;\n  }\n  \n  wrap.add( axis );\n  \n  var arrow = new THREE.Mesh(\n    new THREE.CylinderGeometry(0, 4*axisRadius, 8*axisRadius, axisTess, 1, true), \n    axisMaterial\n  );\n  if (axisOrientation === \"x\") {\n    arrow.rotation.z = - Math.PI / 2;\n    arrow.position.x = axisLength - 1 + axisRadius*4/2;\n  } else if (axisOrientation === \"y\") {\n    arrow.position.y = axisLength - 1 + axisRadius*4/2;\n  }\n\n  wrap.add( arrow );\n  return wrap;\n};\n\n/**\n * Creates an Object3D which contains all axes\n * @param  {Object} params\n * @param  {object} params.axisRadius=0.04  cylinder radius\n * @param  {object} params.axisLength=11    cylinder length\n * @param  {object} params.axisTess=46      cylinder tesselation\n * @return {THREE.Object3D}\n */\nCoordinates.prototype.drawAllAxes = function (params) {\n  params = params || {};\n  var axisRadius = params.axisRadius !== undefined ? params.axisRadius:0.04;\n  var axisLength = params.axisLength !== undefined ? params.axisLength:10;\n  var axisTess = params.axisTess !== undefined ? params.axisTess:24;\n\n  var wrap = new THREE.Object3D();\n\n  var axisXMaterial = new THREE.MeshLambertMaterial({ color: 0xFF0000 });\n  var axisYMaterial = new THREE.MeshLambertMaterial({ color: 0x00FF00 });\n  var axisZMaterial = new THREE.MeshLambertMaterial({ color: 0x0000FF });\n  axisXMaterial.side = THREE.DoubleSide;\n  axisYMaterial.side = THREE.DoubleSide;\n  axisZMaterial.side = THREE.DoubleSide;\n  var axisX = new THREE.Mesh(\n    new THREE.CylinderGeometry(axisRadius, axisRadius, axisLength, axisTess, 1, true), \n    axisXMaterial\n  );\n  var axisY = new THREE.Mesh(\n    new THREE.CylinderGeometry(axisRadius, axisRadius, axisLength, axisTess, 1, true), \n    axisYMaterial\n  );\n  var axisZ = new THREE.Mesh(\n    new THREE.CylinderGeometry(axisRadius, axisRadius, axisLength, axisTess, 1, true), \n    axisZMaterial\n  );\n  axisX.rotation.z = - Math.PI / 2;\n  axisX.position.x = axisLength/2-1;\n\n  axisY.position.y = axisLength/2-1;\n  \n  axisZ.rotation.y = - Math.PI / 2;\n  axisZ.rotation.z = - Math.PI / 2;\n  axisZ.position.z = axisLength/2-1;\n\n  wrap.add( axisX );\n  wrap.add( axisY );\n  wrap.add( axisZ );\n\n  var arrowX = new THREE.Mesh(\n    new THREE.CylinderGeometry(0, 4*axisRadius, 4*axisRadius, axisTess, 1, true), \n    axisXMaterial\n  );\n  var arrowY = new THREE.Mesh(\n    new THREE.CylinderGeometry(0, 4*axisRadius, 4*axisRadius, axisTess, 1, true), \n    axisYMaterial\n  );\n  var arrowZ = new THREE.Mesh(\n    new THREE.CylinderGeometry(0, 4*axisRadius, 4*axisRadius, axisTess, 1, true), \n    axisZMaterial\n  );\n  arrowX.rotation.z = - Math.PI / 2;\n  arrowX.position.x = axisLength - 1 + axisRadius*4/2;\n\n  arrowY.position.y = axisLength - 1 + axisRadius*4/2;\n\n  arrowZ.rotation.z = - Math.PI / 2;\n  arrowZ.rotation.y = - Math.PI / 2;\n  arrowZ.position.z = axisLength - 1 + axisRadius*4/2;\n\n  wrap.add( arrowX );\n  wrap.add( arrowY );\n  wrap.add( arrowZ );\n  return wrap;\n};\n\nmodule.exports = Coordinates;","/**\n * @module themes/light\n */\n\n/**\n * Light theme\n * @name LightTheme\n * @type {Object}\n */\nmodule.exports = {\n\tclearColor: 0xf2fcff,\n  fogColor: 0xf2fcff,\n\tgroundColor: 0xeeeeee\n};","/**\n * @module  controller/Keyboard\n */\n\n/**\n * Keyboard helper\n * @class\n */\nfunction Keyboard() {\n  /**\n   * Each index correspond to the ascii value of the\n   * key pressed\n   * @type {Array}\n   */\n  this.keys = [];\n}\n\n/**\n * Adds the keydown and keyup listeners\n */\nKeyboard.prototype.init = function () {\n  var me = this,\n    i;\n  for (i = 0; i < 256; i += 1) {\n    me.keys[i] = false;\n  }\n  document.addEventListener('keydown', me.onKeyDown(), false);\n  document.addEventListener('keyup', me.onKeyUp(), false);\n};\n\n/**\n * Sets `event.keycode` as a preseed key\n * @return {function}\n */\nKeyboard.prototype.onKeyDown = function () {\n  var me = this;\n  return function (event) {\n    me.keys[event.keyCode] = true;\n  };\n};\n\n/**\n * Sets `event.keycode` as an unpressed key\n * @return {function}\n */\nKeyboard.prototype.onKeyUp = function () {\n  var me = this;\n  return function (event) {\n    me.keys[event.keyCode] = false;\n  };\n};\n\n/**\n * Gets the pressed state of the key `key`\n * @param  {string} key\n * @return {boolean}\n */\nKeyboard.prototype.get = function (key) {\n  return this.keys[key.charCodeAt(0)];\n};\n\n/**\n * Sets the pressed state of the key `key` to `value`\n * @param {string} key\n * @param {boolean} value\n */\nKeyboard.prototype.set = function (key, value) {\n  this.keys[key.charCodeAt(0)] = value;\n};\n\nmodule.exports = Keyboard;","var Application = require('./Application');\nvar THREE = window.THREE;\n\n/**\n * @module  controller/LoopManager\n */\n\n/**\n * The loop managers controls the calls made to `requestAnimationFrame`\n * of an Application\n * @class\n * @param {controller/LoopManager} application Applicaton whose frame rate\n * will be controlled\n * @param {boolean} renderImmediately True to start the call\n * to request animation frame immediately\n */\nfunction LoopManager(application, renderImmediately) {\n  /**\n   * Reference to the application\n   * @type {controller/Application}\n   */\n  this.application = application;\n  /**\n   * Clock helper (its delta method is used to update the camera)\n   * @type {THREE.Clock()}\n   */\n  this.clock = new THREE.Clock();\n  /**\n   * Toggle to pause the animation\n   * @type {boolean}\n   */\n  this.pause = !renderImmediately;\n  /**\n   * Frames per second\n   * @type {number}\n   */\n  this.fps = 60;\n\n  /**\n   * dat.gui folder objects\n   * @type {Object}\n   */\n  this.guiControllers = {};\n};\n\n/**\n * Initializes a folder to control the frame rate and sets\n * the paused state of the app\n * @param  {dat.gui} gui\n * @return {this}\n */\nLoopManager.prototype.initDatGui = function (gui) {\n  var me = this,\n      folder = gui.addFolder('Game Loop');\n  folder\n    .add(this, 'fps', 10, 60, 1)\n    .name('Frame rate');\n  \n  me.guiControllers.pause = folder\n    .add(this, 'pause')\n    .name('Paused')\n    .onFinishChange(function (paused) {\n      if (!paused) {\n        me.animate();\n      }\n      me.application.maskVisible(paused);\n    });\n  return this;\n};\n\n/**\n * Animation loop (calls application.update and application.render)\n * @return {this}\n */\nLoopManager.prototype.animate = function () {\n  var me = this,\n    elapsedTime = 0,\n    loop;\n\n  loop = function () {\n    if (me.pause) {\n      return;\n    }\n\n    var delta = me.clock.getDelta(),\n      frameRateInS = 1 / me.fps;\n\n    // constraint delta to be <= frameRate\n    // (to avoid frames with a big delta caused because of the app sent to sleep)\n    delta = Math.min(delta, frameRateInS);\n    elapsedTime += delta;\n\n    if (elapsedTime >= frameRateInS) {\n\n      // update the world and render its objects\n      me.application.update(delta);\n      me.application.render();\n\n      elapsedTime -= frameRateInS;\n    }\n\n    // details at http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating\n    window.requestAnimationFrame(loop);\n  };\n\n  loop();\n\n  return me;\n};\n\n/**\n * Starts the animation\n */\nLoopManager.prototype.start = function () {\n  var me = this;\n  me.guiControllers.pause.setValue(false);\n};\n\n/**\n * Stops the animation\n */\nLoopManager.prototype.stop = function () {\n  var me = this;\n  me.guiControllers.pause.setValue(true);\n};\n\nmodule.exports = LoopManager;","/**\n * @name THREEx\n * three.js extensions\n * @type {Object}\n */\nmodule.exports = {\n  WindowResize: require('./WindowResize'),\n  FullScreen: require('./FullScreen')\n};","/**\n * @module  lib/THREEx/WindowResize\n */\n\n/**\n * This helper makes it easy to handle window resize.\n * It will update renderer and camera when window is resized.\n *\n * @example\n * // Start updating renderer and camera\n * var windowResize = WindowResize(aRenderer, aCamera);\n * //Start updating renderer and camera\n * windowResize.stop()\n *\n * @namespace\n * @param {Object} renderer the renderer to update\n * @param {Object} Camera the camera to update\n */\nvar windowResize = function (renderer, camera) {\n\tvar callback = function() {\n\t\t// notify the renderer of the size change\n\t\trenderer.setSize( window.innerWidth, window.innerHeight );\n\t\t// update the camera\n\t\tcamera.aspect\t= window.innerWidth / window.innerHeight;\n\t\tcamera.updateProjectionMatrix();\n\t};\n\t// bind the resize event\n\twindow.addEventListener('resize', callback, false);\n\t// return .stop() the function to stop watching window resize\n\treturn {\n\t\tstop\t: function(){\n\t\t\twindow.removeEventListener('resize', callback);\n\t\t}\n\t};\n};\n\n/**\n * @static\n * @param  {THREE.WebGLRenderer} renderer\n * @param  {THREE.PerspectiveCamera} camera\n * @return {Object}\n */\nwindowResize.bind\t= function(renderer, camera){\n\treturn windowResize(renderer, camera);\n};\n\nmodule.exports = windowResize;","/**\n * @module  lib/THREEx/FullScreen\n */\n\n/**\n* This helper makes it easy to handle the fullscreen API:\n* \n* - it hides the prefix for each browser\n* - it hides the little discrepencies of the various vendor API\n* - at the time of this writing (nov 2011) it is available in \n* \n*   [firefox nightly](http://blog.pearce.org.nz/2011/11/firefoxs-html-full-screen-api-enabled.html),\n*   [webkit nightly](http://peter.sh/2011/01/javascript-full-screen-api-navigation-timing-and-repeating-css-gradients/) and\n*   [chrome stable](http://updates.html5rocks.com/2011/10/Let-Your-Content-Do-the-Talking-Fullscreen-API).\n* \n* @namespace\n*/\nvar fullScreen = {};\n\n/**\n * test if it is possible to have fullscreen\n * @returns {boolean} true if fullscreen API is available, false otherwise\n */\nfullScreen.available = function () {\n  return this._hasWebkitFullScreen || this._hasMozFullScreen;\n};\n\n/**\n * Test if fullscreen is currently activated\n * @returns {boolean} true if fullscreen is currently activated, false otherwise\n */\nfullScreen.activated = function () {\n  if (this._hasWebkitFullScreen) {\n    return document.webkitIsFullScreen;\n  } else if (this._hasMozFullScreen) {\n    return document.mozFullScreen;\n  } else {\n    console.assert(false);\n  }\n};\n\n/**\n * Request fullscreen on a given element\n * @param {DomElement} element to make fullscreen. optional. default to document.body\n */\nfullScreen.request = function (element) {\n  element = element || document.body;\n  if (this._hasWebkitFullScreen) {\n    element.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT);\n  } else if (this._hasMozFullScreen) {\n    element.mozRequestFullScreen();\n  } else {\n    console.assert(false);\n  }\n};\n\n/**\n * Cancel fullscreen\n */\nfullScreen.cancel = function () {\n  if (this._hasWebkitFullScreen) {\n    document.webkitCancelFullScreen();\n  } else if (this._hasMozFullScreen) {\n    document.mozCancelFullScreen();\n  } else {\n    console.assert(false);\n  }\n};\n\n\n// internal functions to know which fullscreen API implementation is available\nfullScreen._hasWebkitFullScreen = 'webkitCancelFullScreen' in document ? true : false;\nfullScreen._hasMozFullScreen = 'mozCancelFullScreen' in document ? true : false;\n\n/**\n * Bind a key to renderer screenshot\n * @param {Object} opts\n * @param {Object} [opts.charcode=f]\n * @param {Object} [opts.dblClick=false] True to make it go\n * fullscreen on double click\n */\nfullScreen.bindKey = function (opts) {\n  opts = opts || {};\n  var charCode = opts.charCode || 'f'.charCodeAt(0);\n  var dblclick = opts.dblclick !== undefined ? opts.dblclick : false;\n  var element = opts.element;\n\n  var toggle = function () {\n    if (fullScreen.activated()) {\n      fullScreen.cancel();\n    } else {\n      fullScreen.request(element);\n    }\n  };\n\n  // callback to handle keypress\n  var __bind = function (fn, me) {\n    return function () {\n      return fn.apply(me, arguments);\n    };\n  };\n  var onKeyPress = __bind(function (event) {\n    // return now if the KeyPress isnt for the proper charCode\n    if (event.which !== charCode) { return; }\n    // toggle fullscreen\n    toggle();\n  }, this);\n\n  // listen to keypress\n  // NOTE: for firefox it seems mandatory to listen to document directly\n  document.addEventListener('keypress', onKeyPress, false);\n  // listen to dblclick\n  dblclick && document.addEventListener('dblclick', toggle, false);\n\n  return {\n    unbind: function () {\n      document.removeEventListener('keypress', onKeyPress, false);\n      dblclick && document.removeEventListener('dblclick', toggle, false);\n    }\n  };\n};\n\nmodule.exports = fullScreen;","var hasOwn = Object.prototype.hasOwnProperty;\nvar toString = Object.prototype.toString;\nvar undefined;\n\nvar isPlainObject = function isPlainObject(obj) {\n\t'use strict';\n\tif (!obj || toString.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar has_own_constructor = hasOwn.call(obj, 'constructor');\n\tvar has_is_property_of_method = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !has_own_constructor && !has_is_property_of_method) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) {}\n\n\treturn key === undefined || hasOwn.call(obj, key);\n};\n\nmodule.exports = function extend() {\n\t'use strict';\n\tvar options, name, src, copy, copyIsArray, clone,\n\t\ttarget = arguments[0],\n\t\ti = 1,\n\t\tlength = arguments.length,\n\t\tdeep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t} else if ((typeof target !== 'object' && typeof target !== 'function') || target == null) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = target[name];\n\t\t\t\tcopy = options[name];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target === copy) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = Array.isArray(copy)))) {\n\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\tclone = src && Array.isArray(src) ? src : [];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t}\n\n\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\ttarget[name] = extend(deep, clone, copy);\n\n\t\t\t\t// Don't bring in undefined values\n\t\t\t\t} else if (copy !== undefined) {\n\t\t\t\t\ttarget[name] = copy;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\n","// stats.js - http://github.com/mrdoob/stats.js\nvar Stats=function(){var l=Date.now(),m=l,g=0,n=Infinity,o=0,h=0,p=Infinity,q=0,r=0,s=0,f=document.createElement(\"div\");f.id=\"stats\";f.addEventListener(\"mousedown\",function(b){b.preventDefault();t(++s%2)},!1);f.style.cssText=\"width:80px;opacity:0.9;cursor:pointer\";var a=document.createElement(\"div\");a.id=\"fps\";a.style.cssText=\"padding:0 0 3px 3px;text-align:left;background-color:#002\";f.appendChild(a);var i=document.createElement(\"div\");i.id=\"fpsText\";i.style.cssText=\"color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px\";\ni.innerHTML=\"FPS\";a.appendChild(i);var c=document.createElement(\"div\");c.id=\"fpsGraph\";c.style.cssText=\"position:relative;width:74px;height:30px;background-color:#0ff\";for(a.appendChild(c);74>c.children.length;){var j=document.createElement(\"span\");j.style.cssText=\"width:1px;height:30px;float:left;background-color:#113\";c.appendChild(j)}var d=document.createElement(\"div\");d.id=\"ms\";d.style.cssText=\"padding:0 0 3px 3px;text-align:left;background-color:#020;display:none\";f.appendChild(d);var k=document.createElement(\"div\");\nk.id=\"msText\";k.style.cssText=\"color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px\";k.innerHTML=\"MS\";d.appendChild(k);var e=document.createElement(\"div\");e.id=\"msGraph\";e.style.cssText=\"position:relative;width:74px;height:30px;background-color:#0f0\";for(d.appendChild(e);74>e.children.length;)j=document.createElement(\"span\"),j.style.cssText=\"width:1px;height:30px;float:left;background-color:#131\",e.appendChild(j);var t=function(b){s=b;switch(s){case 0:a.style.display=\n\"block\";d.style.display=\"none\";break;case 1:a.style.display=\"none\",d.style.display=\"block\"}};return{REVISION:12,domElement:f,setMode:t,begin:function(){l=Date.now()},end:function(){var b=Date.now();g=b-l;n=Math.min(n,g);o=Math.max(o,g);k.textContent=g+\" MS (\"+n+\"-\"+o+\")\";var a=Math.min(30,30-30*(g/200));e.appendChild(e.firstChild).style.height=a+\"px\";r++;b>m+1E3&&(h=Math.round(1E3*r/(b-m)),p=Math.min(p,h),q=Math.max(q,h),i.textContent=h+\" FPS (\"+p+\"-\"+q+\")\",a=Math.min(30,30-30*(h/100)),c.appendChild(c.firstChild).style.height=\na+\"px\",m=b,r=0);return b},update:function(){l=this.end()}}};\"object\"===typeof module&&(module.exports=Stats);\n","module.exports = require('./vendor/dat.gui')\nmodule.exports.color = require('./vendor/dat.color')","/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n/** @namespace */\nvar dat = module.exports = dat || {};\n\n/** @namespace */\ndat.color = dat.color || {};\n\n/** @namespace */\ndat.utils = dat.utils || {};\n\ndat.utils.common = (function () {\n  \n  var ARR_EACH = Array.prototype.forEach;\n  var ARR_SLICE = Array.prototype.slice;\n\n  /**\n   * Band-aid methods for things that should be a lot easier in JavaScript.\n   * Implementation and structure inspired by underscore.js\n   * http://documentcloud.github.com/underscore/\n   */\n\n  return { \n    \n    BREAK: {},\n  \n    extend: function(target) {\n      \n      this.each(ARR_SLICE.call(arguments, 1), function(obj) {\n        \n        for (var key in obj)\n          if (!this.isUndefined(obj[key])) \n            target[key] = obj[key];\n        \n      }, this);\n      \n      return target;\n      \n    },\n    \n    defaults: function(target) {\n      \n      this.each(ARR_SLICE.call(arguments, 1), function(obj) {\n        \n        for (var key in obj)\n          if (this.isUndefined(target[key])) \n            target[key] = obj[key];\n        \n      }, this);\n      \n      return target;\n    \n    },\n    \n    compose: function() {\n      var toCall = ARR_SLICE.call(arguments);\n            return function() {\n              var args = ARR_SLICE.call(arguments);\n              for (var i = toCall.length -1; i >= 0; i--) {\n                args = [toCall[i].apply(this, args)];\n              }\n              return args[0];\n            }\n    },\n    \n    each: function(obj, itr, scope) {\n\n      \n      if (ARR_EACH && obj.forEach === ARR_EACH) { \n        \n        obj.forEach(itr, scope);\n        \n      } else if (obj.length === obj.length + 0) { // Is number but not NaN\n        \n        for (var key = 0, l = obj.length; key < l; key++)\n          if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) \n            return;\n            \n      } else {\n\n        for (var key in obj) \n          if (itr.call(scope, obj[key], key) === this.BREAK)\n            return;\n            \n      }\n            \n    },\n    \n    defer: function(fnc) {\n      setTimeout(fnc, 0);\n    },\n    \n    toArray: function(obj) {\n      if (obj.toArray) return obj.toArray();\n      return ARR_SLICE.call(obj);\n    },\n\n    isUndefined: function(obj) {\n      return obj === undefined;\n    },\n    \n    isNull: function(obj) {\n      return obj === null;\n    },\n    \n    isNaN: function(obj) {\n      return obj !== obj;\n    },\n    \n    isArray: Array.isArray || function(obj) {\n      return obj.constructor === Array;\n    },\n    \n    isObject: function(obj) {\n      return obj === Object(obj);\n    },\n    \n    isNumber: function(obj) {\n      return obj === obj+0;\n    },\n    \n    isString: function(obj) {\n      return obj === obj+'';\n    },\n    \n    isBoolean: function(obj) {\n      return obj === false || obj === true;\n    },\n    \n    isFunction: function(obj) {\n      return Object.prototype.toString.call(obj) === '[object Function]';\n    }\n  \n  };\n    \n})();\n\n\ndat.color.toString = (function (common) {\n\n  return function(color) {\n\n    if (color.a == 1 || common.isUndefined(color.a)) {\n\n      var s = color.hex.toString(16);\n      while (s.length < 6) {\n        s = '0' + s;\n      }\n\n      return '#' + s;\n\n    } else {\n\n      return 'rgba(' + Math.round(color.r) + ',' + Math.round(color.g) + ',' + Math.round(color.b) + ',' + color.a + ')';\n\n    }\n\n  }\n\n})(dat.utils.common);\n\n\ndat.Color = dat.color.Color = (function (interpret, math, toString, common) {\n\n  var Color = function() {\n\n    this.__state = interpret.apply(this, arguments);\n\n    if (this.__state === false) {\n      throw 'Failed to interpret color arguments';\n    }\n\n    this.__state.a = this.__state.a || 1;\n\n\n  };\n\n  Color.COMPONENTS = ['r','g','b','h','s','v','hex','a'];\n\n  common.extend(Color.prototype, {\n\n    toString: function() {\n      return toString(this);\n    },\n\n    toOriginal: function() {\n      return this.__state.conversion.write(this);\n    }\n\n  });\n\n  defineRGBComponent(Color.prototype, 'r', 2);\n  defineRGBComponent(Color.prototype, 'g', 1);\n  defineRGBComponent(Color.prototype, 'b', 0);\n\n  defineHSVComponent(Color.prototype, 'h');\n  defineHSVComponent(Color.prototype, 's');\n  defineHSVComponent(Color.prototype, 'v');\n\n  Object.defineProperty(Color.prototype, 'a', {\n\n    get: function() {\n      return this.__state.a;\n    },\n\n    set: function(v) {\n      this.__state.a = v;\n    }\n\n  });\n\n  Object.defineProperty(Color.prototype, 'hex', {\n\n    get: function() {\n\n      if (!this.__state.space !== 'HEX') {\n        this.__state.hex = math.rgb_to_hex(this.r, this.g, this.b);\n      }\n\n      return this.__state.hex;\n\n    },\n\n    set: function(v) {\n\n      this.__state.space = 'HEX';\n      this.__state.hex = v;\n\n    }\n\n  });\n\n  function defineRGBComponent(target, component, componentHexIndex) {\n\n    Object.defineProperty(target, component, {\n\n      get: function() {\n\n        if (this.__state.space === 'RGB') {\n          return this.__state[component];\n        }\n\n        recalculateRGB(this, component, componentHexIndex);\n\n        return this.__state[component];\n\n      },\n\n      set: function(v) {\n\n        if (this.__state.space !== 'RGB') {\n          recalculateRGB(this, component, componentHexIndex);\n          this.__state.space = 'RGB';\n        }\n\n        this.__state[component] = v;\n\n      }\n\n    });\n\n  }\n\n  function defineHSVComponent(target, component) {\n\n    Object.defineProperty(target, component, {\n\n      get: function() {\n\n        if (this.__state.space === 'HSV')\n          return this.__state[component];\n\n        recalculateHSV(this);\n\n        return this.__state[component];\n\n      },\n\n      set: function(v) {\n\n        if (this.__state.space !== 'HSV') {\n          recalculateHSV(this);\n          this.__state.space = 'HSV';\n        }\n\n        this.__state[component] = v;\n\n      }\n\n    });\n\n  }\n\n  function recalculateRGB(color, component, componentHexIndex) {\n\n    if (color.__state.space === 'HEX') {\n\n      color.__state[component] = math.component_from_hex(color.__state.hex, componentHexIndex);\n\n    } else if (color.__state.space === 'HSV') {\n\n      common.extend(color.__state, math.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\n\n    } else {\n\n      throw 'Corrupted color state';\n\n    }\n\n  }\n\n  function recalculateHSV(color) {\n\n    var result = math.rgb_to_hsv(color.r, color.g, color.b);\n\n    common.extend(color.__state,\n        {\n          s: result.s,\n          v: result.v\n        }\n    );\n\n    if (!common.isNaN(result.h)) {\n      color.__state.h = result.h;\n    } else if (common.isUndefined(color.__state.h)) {\n      color.__state.h = 0;\n    }\n\n  }\n\n  return Color;\n\n})(dat.color.interpret = (function (toString, common) {\n\n  var result, toReturn;\n\n  var interpret = function() {\n\n    toReturn = false;\n\n    var original = arguments.length > 1 ? common.toArray(arguments) : arguments[0];\n\n    common.each(INTERPRETATIONS, function(family) {\n\n      if (family.litmus(original)) {\n\n        common.each(family.conversions, function(conversion, conversionName) {\n\n          result = conversion.read(original);\n\n          if (toReturn === false && result !== false) {\n            toReturn = result;\n            result.conversionName = conversionName;\n            result.conversion = conversion;\n            return common.BREAK;\n\n          }\n\n        });\n\n        return common.BREAK;\n\n      }\n\n    });\n\n    return toReturn;\n\n  };\n\n  var INTERPRETATIONS = [\n\n    // Strings\n    {\n\n      litmus: common.isString,\n\n      conversions: {\n\n        THREE_CHAR_HEX: {\n\n          read: function(original) {\n\n            var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\n            if (test === null) return false;\n\n            return {\n              space: 'HEX',\n              hex: parseInt(\n                  '0x' +\n                      test[1].toString() + test[1].toString() +\n                      test[2].toString() + test[2].toString() +\n                      test[3].toString() + test[3].toString())\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        SIX_CHAR_HEX: {\n\n          read: function(original) {\n\n            var test = original.match(/^#([A-F0-9]{6})$/i);\n            if (test === null) return false;\n\n            return {\n              space: 'HEX',\n              hex: parseInt('0x' + test[1].toString())\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        CSS_RGB: {\n\n          read: function(original) {\n\n            var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\n            if (test === null) return false;\n\n            return {\n              space: 'RGB',\n              r: parseFloat(test[1]),\n              g: parseFloat(test[2]),\n              b: parseFloat(test[3])\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        CSS_RGBA: {\n\n          read: function(original) {\n\n            var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\,\\s*(.+)\\s*\\)/);\n            if (test === null) return false;\n\n            return {\n              space: 'RGB',\n              r: parseFloat(test[1]),\n              g: parseFloat(test[2]),\n              b: parseFloat(test[3]),\n              a: parseFloat(test[4])\n            };\n\n          },\n\n          write: toString\n\n        }\n\n      }\n\n    },\n\n    // Numbers\n    {\n\n      litmus: common.isNumber,\n\n      conversions: {\n\n        HEX: {\n          read: function(original) {\n            return {\n              space: 'HEX',\n              hex: original,\n              conversionName: 'HEX'\n            }\n          },\n\n          write: function(color) {\n            return color.hex;\n          }\n        }\n\n      }\n\n    },\n\n    // Arrays\n    {\n\n      litmus: common.isArray,\n\n      conversions: {\n\n        RGB_ARRAY: {\n          read: function(original) {\n            if (original.length != 3) return false;\n            return {\n              space: 'RGB',\n              r: original[0],\n              g: original[1],\n              b: original[2]\n            };\n          },\n\n          write: function(color) {\n            return [color.r, color.g, color.b];\n          }\n\n        },\n\n        RGBA_ARRAY: {\n          read: function(original) {\n            if (original.length != 4) return false;\n            return {\n              space: 'RGB',\n              r: original[0],\n              g: original[1],\n              b: original[2],\n              a: original[3]\n            };\n          },\n\n          write: function(color) {\n            return [color.r, color.g, color.b, color.a];\n          }\n\n        }\n\n      }\n\n    },\n\n    // Objects\n    {\n\n      litmus: common.isObject,\n\n      conversions: {\n\n        RGBA_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.r) &&\n                common.isNumber(original.g) &&\n                common.isNumber(original.b) &&\n                common.isNumber(original.a)) {\n              return {\n                space: 'RGB',\n                r: original.r,\n                g: original.g,\n                b: original.b,\n                a: original.a\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              r: color.r,\n              g: color.g,\n              b: color.b,\n              a: color.a\n            }\n          }\n        },\n\n        RGB_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.r) &&\n                common.isNumber(original.g) &&\n                common.isNumber(original.b)) {\n              return {\n                space: 'RGB',\n                r: original.r,\n                g: original.g,\n                b: original.b\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              r: color.r,\n              g: color.g,\n              b: color.b\n            }\n          }\n        },\n\n        HSVA_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.h) &&\n                common.isNumber(original.s) &&\n                common.isNumber(original.v) &&\n                common.isNumber(original.a)) {\n              return {\n                space: 'HSV',\n                h: original.h,\n                s: original.s,\n                v: original.v,\n                a: original.a\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              h: color.h,\n              s: color.s,\n              v: color.v,\n              a: color.a\n            }\n          }\n        },\n\n        HSV_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.h) &&\n                common.isNumber(original.s) &&\n                common.isNumber(original.v)) {\n              return {\n                space: 'HSV',\n                h: original.h,\n                s: original.s,\n                v: original.v\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              h: color.h,\n              s: color.s,\n              v: color.v\n            }\n          }\n\n        }\n\n      }\n\n    }\n\n\n  ];\n\n  return interpret;\n\n\n})(dat.color.toString,\ndat.utils.common),\ndat.color.math = (function () {\n\n  var tmpComponent;\n\n  return {\n\n    hsv_to_rgb: function(h, s, v) {\n\n      var hi = Math.floor(h / 60) % 6;\n\n      var f = h / 60 - Math.floor(h / 60);\n      var p = v * (1.0 - s);\n      var q = v * (1.0 - (f * s));\n      var t = v * (1.0 - ((1.0 - f) * s));\n      var c = [\n        [v, t, p],\n        [q, v, p],\n        [p, v, t],\n        [p, q, v],\n        [t, p, v],\n        [v, p, q]\n      ][hi];\n\n      return {\n        r: c[0] * 255,\n        g: c[1] * 255,\n        b: c[2] * 255\n      };\n\n    },\n\n    rgb_to_hsv: function(r, g, b) {\n\n      var min = Math.min(r, g, b),\n          max = Math.max(r, g, b),\n          delta = max - min,\n          h, s;\n\n      if (max != 0) {\n        s = delta / max;\n      } else {\n        return {\n          h: NaN,\n          s: 0,\n          v: 0\n        };\n      }\n\n      if (r == max) {\n        h = (g - b) / delta;\n      } else if (g == max) {\n        h = 2 + (b - r) / delta;\n      } else {\n        h = 4 + (r - g) / delta;\n      }\n      h /= 6;\n      if (h < 0) {\n        h += 1;\n      }\n\n      return {\n        h: h * 360,\n        s: s,\n        v: max / 255\n      };\n    },\n\n    rgb_to_hex: function(r, g, b) {\n      var hex = this.hex_with_component(0, 2, r);\n      hex = this.hex_with_component(hex, 1, g);\n      hex = this.hex_with_component(hex, 0, b);\n      return hex;\n    },\n\n    component_from_hex: function(hex, componentIndex) {\n      return (hex >> (componentIndex * 8)) & 0xFF;\n    },\n\n    hex_with_component: function(hex, componentIndex, value) {\n      return value << (tmpComponent = componentIndex * 8) | (hex & ~ (0xFF << tmpComponent));\n    }\n\n  }\n\n})(),\ndat.color.toString,\ndat.utils.common);","/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n/** @namespace */\nvar dat = module.exports = dat || {};\n\n/** @namespace */\ndat.gui = dat.gui || {};\n\n/** @namespace */\ndat.utils = dat.utils || {};\n\n/** @namespace */\ndat.controllers = dat.controllers || {};\n\n/** @namespace */\ndat.dom = dat.dom || {};\n\n/** @namespace */\ndat.color = dat.color || {};\n\ndat.utils.css = (function () {\n  return {\n    load: function (url, doc) {\n      doc = doc || document;\n      var link = doc.createElement('link');\n      link.type = 'text/css';\n      link.rel = 'stylesheet';\n      link.href = url;\n      doc.getElementsByTagName('head')[0].appendChild(link);\n    },\n    inject: function(css, doc) {\n      doc = doc || document;\n      var injected = document.createElement('style');\n      injected.type = 'text/css';\n      injected.innerHTML = css;\n      doc.getElementsByTagName('head')[0].appendChild(injected);\n    }\n  }\n})();\n\n\ndat.utils.common = (function () {\n  \n  var ARR_EACH = Array.prototype.forEach;\n  var ARR_SLICE = Array.prototype.slice;\n\n  /**\n   * Band-aid methods for things that should be a lot easier in JavaScript.\n   * Implementation and structure inspired by underscore.js\n   * http://documentcloud.github.com/underscore/\n   */\n\n  return { \n    \n    BREAK: {},\n  \n    extend: function(target) {\n      \n      this.each(ARR_SLICE.call(arguments, 1), function(obj) {\n        \n        for (var key in obj)\n          if (!this.isUndefined(obj[key])) \n            target[key] = obj[key];\n        \n      }, this);\n      \n      return target;\n      \n    },\n    \n    defaults: function(target) {\n      \n      this.each(ARR_SLICE.call(arguments, 1), function(obj) {\n        \n        for (var key in obj)\n          if (this.isUndefined(target[key])) \n            target[key] = obj[key];\n        \n      }, this);\n      \n      return target;\n    \n    },\n    \n    compose: function() {\n      var toCall = ARR_SLICE.call(arguments);\n            return function() {\n              var args = ARR_SLICE.call(arguments);\n              for (var i = toCall.length -1; i >= 0; i--) {\n                args = [toCall[i].apply(this, args)];\n              }\n              return args[0];\n            }\n    },\n    \n    each: function(obj, itr, scope) {\n\n      \n      if (ARR_EACH && obj.forEach === ARR_EACH) { \n        \n        obj.forEach(itr, scope);\n        \n      } else if (obj.length === obj.length + 0) { // Is number but not NaN\n        \n        for (var key = 0, l = obj.length; key < l; key++)\n          if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) \n            return;\n            \n      } else {\n\n        for (var key in obj) \n          if (itr.call(scope, obj[key], key) === this.BREAK)\n            return;\n            \n      }\n            \n    },\n    \n    defer: function(fnc) {\n      setTimeout(fnc, 0);\n    },\n    \n    toArray: function(obj) {\n      if (obj.toArray) return obj.toArray();\n      return ARR_SLICE.call(obj);\n    },\n\n    isUndefined: function(obj) {\n      return obj === undefined;\n    },\n    \n    isNull: function(obj) {\n      return obj === null;\n    },\n    \n    isNaN: function(obj) {\n      return obj !== obj;\n    },\n    \n    isArray: Array.isArray || function(obj) {\n      return obj.constructor === Array;\n    },\n    \n    isObject: function(obj) {\n      return obj === Object(obj);\n    },\n    \n    isNumber: function(obj) {\n      return obj === obj+0;\n    },\n    \n    isString: function(obj) {\n      return obj === obj+'';\n    },\n    \n    isBoolean: function(obj) {\n      return obj === false || obj === true;\n    },\n    \n    isFunction: function(obj) {\n      return Object.prototype.toString.call(obj) === '[object Function]';\n    }\n  \n  };\n    \n})();\n\n\ndat.controllers.Controller = (function (common) {\n\n  /**\n   * @class An \"abstract\" class that represents a given property of an object.\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   *\n   * @member dat.controllers\n   */\n  var Controller = function(object, property) {\n\n    this.initialValue = object[property];\n\n    /**\n     * Those who extend this class will put their DOM elements in here.\n     * @type {DOMElement}\n     */\n    this.domElement = document.createElement('div');\n\n    /**\n     * The object to manipulate\n     * @type {Object}\n     */\n    this.object = object;\n\n    /**\n     * The name of the property to manipulate\n     * @type {String}\n     */\n    this.property = property;\n\n    /**\n     * The function to be called on change.\n     * @type {Function}\n     * @ignore\n     */\n    this.__onChange = undefined;\n\n    /**\n     * The function to be called on finishing change.\n     * @type {Function}\n     * @ignore\n     */\n    this.__onFinishChange = undefined;\n\n  };\n\n  common.extend(\n\n      Controller.prototype,\n\n      /** @lends dat.controllers.Controller.prototype */\n      {\n\n        /**\n         * Specify that a function fire every time someone changes the value with\n         * this Controller.\n         *\n         * @param {Function} fnc This function will be called whenever the value\n         * is modified via this Controller.\n         * @returns {dat.controllers.Controller} this\n         */\n        onChange: function(fnc) {\n          this.__onChange = fnc;\n          return this;\n        },\n\n        /**\n         * Specify that a function fire every time someone \"finishes\" changing\n         * the value wih this Controller. Useful for values that change\n         * incrementally like numbers or strings.\n         *\n         * @param {Function} fnc This function will be called whenever\n         * someone \"finishes\" changing the value via this Controller.\n         * @returns {dat.controllers.Controller} this\n         */\n        onFinishChange: function(fnc) {\n          this.__onFinishChange = fnc;\n          return this;\n        },\n\n        /**\n         * Change the value of <code>object[property]</code>\n         *\n         * @param {Object} newValue The new value of <code>object[property]</code>\n         */\n        setValue: function(newValue) {\n          this.object[this.property] = newValue;\n          if (this.__onChange) {\n            this.__onChange.call(this, newValue);\n          }\n          this.updateDisplay();\n          return this;\n        },\n\n        /**\n         * Gets the value of <code>object[property]</code>\n         *\n         * @returns {Object} The current value of <code>object[property]</code>\n         */\n        getValue: function() {\n          return this.object[this.property];\n        },\n\n        /**\n         * Refreshes the visual display of a Controller in order to keep sync\n         * with the object's current value.\n         * @returns {dat.controllers.Controller} this\n         */\n        updateDisplay: function() {\n          return this;\n        },\n\n        /**\n         * @returns {Boolean} true if the value has deviated from initialValue\n         */\n        isModified: function() {\n          return this.initialValue !== this.getValue()\n        }\n\n      }\n\n  );\n\n  return Controller;\n\n\n})(dat.utils.common);\n\n\ndat.dom.dom = (function (common) {\n\n  var EVENT_MAP = {\n    'HTMLEvents': ['change'],\n    'MouseEvents': ['click','mousemove','mousedown','mouseup', 'mouseover'],\n    'KeyboardEvents': ['keydown']\n  };\n\n  var EVENT_MAP_INV = {};\n  common.each(EVENT_MAP, function(v, k) {\n    common.each(v, function(e) {\n      EVENT_MAP_INV[e] = k;\n    });\n  });\n\n  var CSS_VALUE_PIXELS = /(\\d+(\\.\\d+)?)px/;\n\n  function cssValueToPixels(val) {\n\n    if (val === '0' || common.isUndefined(val)) return 0;\n\n    var match = val.match(CSS_VALUE_PIXELS);\n\n    if (!common.isNull(match)) {\n      return parseFloat(match[1]);\n    }\n\n    // TODO ...ems? %?\n\n    return 0;\n\n  }\n\n  /**\n   * @namespace\n   * @member dat.dom\n   */\n  var dom = {\n\n    /**\n     * \n     * @param elem\n     * @param selectable\n     */\n    makeSelectable: function(elem, selectable) {\n\n      if (elem === undefined || elem.style === undefined) return;\n\n      elem.onselectstart = selectable ? function() {\n        return false;\n      } : function() {\n      };\n\n      elem.style.MozUserSelect = selectable ? 'auto' : 'none';\n      elem.style.KhtmlUserSelect = selectable ? 'auto' : 'none';\n      elem.unselectable = selectable ? 'on' : 'off';\n\n    },\n\n    /**\n     *\n     * @param elem\n     * @param horizontal\n     * @param vertical\n     */\n    makeFullscreen: function(elem, horizontal, vertical) {\n\n      if (common.isUndefined(horizontal)) horizontal = true;\n      if (common.isUndefined(vertical)) vertical = true;\n\n      elem.style.position = 'absolute';\n\n      if (horizontal) {\n        elem.style.left = 0;\n        elem.style.right = 0;\n      }\n      if (vertical) {\n        elem.style.top = 0;\n        elem.style.bottom = 0;\n      }\n\n    },\n\n    /**\n     *\n     * @param elem\n     * @param eventType\n     * @param params\n     */\n    fakeEvent: function(elem, eventType, params, aux) {\n      params = params || {};\n      var className = EVENT_MAP_INV[eventType];\n      if (!className) {\n        throw new Error('Event type ' + eventType + ' not supported.');\n      }\n      var evt = document.createEvent(className);\n      switch (className) {\n        case 'MouseEvents':\n          var clientX = params.x || params.clientX || 0;\n          var clientY = params.y || params.clientY || 0;\n          evt.initMouseEvent(eventType, params.bubbles || false,\n              params.cancelable || true, window, params.clickCount || 1,\n              0, //screen X\n              0, //screen Y\n              clientX, //client X\n              clientY, //client Y\n              false, false, false, false, 0, null);\n          break;\n        case 'KeyboardEvents':\n          var init = evt.initKeyboardEvent || evt.initKeyEvent; // webkit || moz\n          common.defaults(params, {\n            cancelable: true,\n            ctrlKey: false,\n            altKey: false,\n            shiftKey: false,\n            metaKey: false,\n            keyCode: undefined,\n            charCode: undefined\n          });\n          init(eventType, params.bubbles || false,\n              params.cancelable, window,\n              params.ctrlKey, params.altKey,\n              params.shiftKey, params.metaKey,\n              params.keyCode, params.charCode);\n          break;\n        default:\n          evt.initEvent(eventType, params.bubbles || false,\n              params.cancelable || true);\n          break;\n      }\n      common.defaults(evt, aux);\n      elem.dispatchEvent(evt);\n    },\n\n    /**\n     *\n     * @param elem\n     * @param event\n     * @param func\n     * @param bool\n     */\n    bind: function(elem, event, func, bool) {\n      bool = bool || false;\n      if (elem.addEventListener)\n        elem.addEventListener(event, func, bool);\n      else if (elem.attachEvent)\n        elem.attachEvent('on' + event, func);\n      return dom;\n    },\n\n    /**\n     *\n     * @param elem\n     * @param event\n     * @param func\n     * @param bool\n     */\n    unbind: function(elem, event, func, bool) {\n      bool = bool || false;\n      if (elem.removeEventListener)\n        elem.removeEventListener(event, func, bool);\n      else if (elem.detachEvent)\n        elem.detachEvent('on' + event, func);\n      return dom;\n    },\n\n    /**\n     *\n     * @param elem\n     * @param className\n     */\n    addClass: function(elem, className) {\n      if (elem.className === undefined) {\n        elem.className = className;\n      } else if (elem.className !== className) {\n        var classes = elem.className.split(/ +/);\n        if (classes.indexOf(className) == -1) {\n          classes.push(className);\n          elem.className = classes.join(' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\n        }\n      }\n      return dom;\n    },\n\n    /**\n     *\n     * @param elem\n     * @param className\n     */\n    removeClass: function(elem, className) {\n      if (className) {\n        if (elem.className === undefined) {\n          // elem.className = className;\n        } else if (elem.className === className) {\n          elem.removeAttribute('class');\n        } else {\n          var classes = elem.className.split(/ +/);\n          var index = classes.indexOf(className);\n          if (index != -1) {\n            classes.splice(index, 1);\n            elem.className = classes.join(' ');\n          }\n        }\n      } else {\n        elem.className = undefined;\n      }\n      return dom;\n    },\n\n    hasClass: function(elem, className) {\n      return new RegExp('(?:^|\\\\s+)' + className + '(?:\\\\s+|$)').test(elem.className) || false;\n    },\n\n    /**\n     *\n     * @param elem\n     */\n    getWidth: function(elem) {\n\n      var style = getComputedStyle(elem);\n\n      return cssValueToPixels(style['border-left-width']) +\n          cssValueToPixels(style['border-right-width']) +\n          cssValueToPixels(style['padding-left']) +\n          cssValueToPixels(style['padding-right']) +\n          cssValueToPixels(style['width']);\n    },\n\n    /**\n     *\n     * @param elem\n     */\n    getHeight: function(elem) {\n\n      var style = getComputedStyle(elem);\n\n      return cssValueToPixels(style['border-top-width']) +\n          cssValueToPixels(style['border-bottom-width']) +\n          cssValueToPixels(style['padding-top']) +\n          cssValueToPixels(style['padding-bottom']) +\n          cssValueToPixels(style['height']);\n    },\n\n    /**\n     *\n     * @param elem\n     */\n    getOffset: function(elem) {\n      var offset = {left: 0, top:0};\n      if (elem.offsetParent) {\n        do {\n          offset.left += elem.offsetLeft;\n          offset.top += elem.offsetTop;\n        } while (elem = elem.offsetParent);\n      }\n      return offset;\n    },\n\n    // http://stackoverflow.com/posts/2684561/revisions\n    /**\n     * \n     * @param elem\n     */\n    isActive: function(elem) {\n      return elem === document.activeElement && ( elem.type || elem.href );\n    }\n\n  };\n\n  return dom;\n\n})(dat.utils.common);\n\n\ndat.controllers.OptionController = (function (Controller, dom, common) {\n\n  /**\n   * @class Provides a select input to alter the property of an object, using a\n   * list of accepted values.\n   *\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   * @param {Object|string[]} options A map of labels to acceptable values, or\n   * a list of acceptable string values.\n   *\n   * @member dat.controllers\n   */\n  var OptionController = function(object, property, options) {\n\n    OptionController.superclass.call(this, object, property);\n\n    var _this = this;\n\n    /**\n     * The drop down menu\n     * @ignore\n     */\n    this.__select = document.createElement('select');\n\n    if (common.isArray(options)) {\n      var map = {};\n      common.each(options, function(element) {\n        map[element] = element;\n      });\n      options = map;\n    }\n\n    common.each(options, function(value, key) {\n\n      var opt = document.createElement('option');\n      opt.innerHTML = key;\n      opt.setAttribute('value', value);\n      _this.__select.appendChild(opt);\n\n    });\n\n    // Acknowledge original value\n    this.updateDisplay();\n\n    dom.bind(this.__select, 'change', function() {\n      var desiredValue = this.options[this.selectedIndex].value;\n      _this.setValue(desiredValue);\n    });\n\n    this.domElement.appendChild(this.__select);\n\n  };\n\n  OptionController.superclass = Controller;\n\n  common.extend(\n\n      OptionController.prototype,\n      Controller.prototype,\n\n      {\n\n        setValue: function(v) {\n          var toReturn = OptionController.superclass.prototype.setValue.call(this, v);\n          if (this.__onFinishChange) {\n            this.__onFinishChange.call(this, this.getValue());\n          }\n          return toReturn;\n        },\n\n        updateDisplay: function() {\n          this.__select.value = this.getValue();\n          return OptionController.superclass.prototype.updateDisplay.call(this);\n        }\n\n      }\n\n  );\n\n  return OptionController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.utils.common);\n\n\ndat.controllers.NumberController = (function (Controller, common) {\n\n  /**\n   * @class Represents a given property of an object that is a number.\n   *\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   * @param {Object} [params] Optional parameters\n   * @param {Number} [params.min] Minimum allowed value\n   * @param {Number} [params.max] Maximum allowed value\n   * @param {Number} [params.step] Increment by which to change value\n   *\n   * @member dat.controllers\n   */\n  var NumberController = function(object, property, params) {\n\n    NumberController.superclass.call(this, object, property);\n\n    params = params || {};\n\n    this.__min = params.min;\n    this.__max = params.max;\n    this.__step = params.step;\n\n    if (common.isUndefined(this.__step)) {\n\n      if (this.initialValue == 0) {\n        this.__impliedStep = 1; // What are we, psychics?\n      } else {\n        // Hey Doug, check this out.\n        this.__impliedStep = Math.pow(10, Math.floor(Math.log(this.initialValue)/Math.LN10))/10;\n      }\n\n    } else {\n\n      this.__impliedStep = this.__step;\n\n    }\n\n    this.__precision = numDecimals(this.__impliedStep);\n\n\n  };\n\n  NumberController.superclass = Controller;\n\n  common.extend(\n\n      NumberController.prototype,\n      Controller.prototype,\n\n      /** @lends dat.controllers.NumberController.prototype */\n      {\n\n        setValue: function(v) {\n\n          if (this.__min !== undefined && v < this.__min) {\n            v = this.__min;\n          } else if (this.__max !== undefined && v > this.__max) {\n            v = this.__max;\n          }\n\n          if (this.__step !== undefined && v % this.__step != 0) {\n            v = Math.round(v / this.__step) * this.__step;\n          }\n\n          return NumberController.superclass.prototype.setValue.call(this, v);\n\n        },\n\n        /**\n         * Specify a minimum value for <code>object[property]</code>.\n         *\n         * @param {Number} minValue The minimum value for\n         * <code>object[property]</code>\n         * @returns {dat.controllers.NumberController} this\n         */\n        min: function(v) {\n          this.__min = v;\n          return this;\n        },\n\n        /**\n         * Specify a maximum value for <code>object[property]</code>.\n         *\n         * @param {Number} maxValue The maximum value for\n         * <code>object[property]</code>\n         * @returns {dat.controllers.NumberController} this\n         */\n        max: function(v) {\n          this.__max = v;\n          return this;\n        },\n\n        /**\n         * Specify a step value that dat.controllers.NumberController\n         * increments by.\n         *\n         * @param {Number} stepValue The step value for\n         * dat.controllers.NumberController\n         * @default if minimum and maximum specified increment is 1% of the\n         * difference otherwise stepValue is 1\n         * @returns {dat.controllers.NumberController} this\n         */\n        step: function(v) {\n          this.__step = v;\n          return this;\n        }\n\n      }\n\n  );\n\n  function numDecimals(x) {\n    x = x.toString();\n    if (x.indexOf('.') > -1) {\n      return x.length - x.indexOf('.') - 1;\n    } else {\n      return 0;\n    }\n  }\n\n  return NumberController;\n\n})(dat.controllers.Controller,\ndat.utils.common);\n\n\ndat.controllers.NumberControllerBox = (function (NumberController, dom, common) {\n\n  /**\n   * @class Represents a given property of an object that is a number and\n   * provides an input element with which to manipulate it.\n   *\n   * @extends dat.controllers.Controller\n   * @extends dat.controllers.NumberController\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   * @param {Object} [params] Optional parameters\n   * @param {Number} [params.min] Minimum allowed value\n   * @param {Number} [params.max] Maximum allowed value\n   * @param {Number} [params.step] Increment by which to change value\n   *\n   * @member dat.controllers\n   */\n  var NumberControllerBox = function(object, property, params) {\n\n    this.__truncationSuspended = false;\n\n    NumberControllerBox.superclass.call(this, object, property, params);\n\n    var _this = this;\n\n    /**\n     * {Number} Previous mouse y position\n     * @ignore\n     */\n    var prev_y;\n\n    this.__input = document.createElement('input');\n    this.__input.setAttribute('type', 'text');\n\n    // Makes it so manually specified values are not truncated.\n\n    dom.bind(this.__input, 'change', onChange);\n    dom.bind(this.__input, 'blur', onBlur);\n    dom.bind(this.__input, 'mousedown', onMouseDown);\n    dom.bind(this.__input, 'keydown', function(e) {\n\n      // When pressing entire, you can be as precise as you want.\n      if (e.keyCode === 13) {\n        _this.__truncationSuspended = true;\n        this.blur();\n        _this.__truncationSuspended = false;\n      }\n\n    });\n\n    function onChange() {\n      var attempted = parseFloat(_this.__input.value);\n      if (!common.isNaN(attempted)) _this.setValue(attempted);\n    }\n\n    function onBlur() {\n      onChange();\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    function onMouseDown(e) {\n      dom.bind(window, 'mousemove', onMouseDrag);\n      dom.bind(window, 'mouseup', onMouseUp);\n      prev_y = e.clientY;\n    }\n\n    function onMouseDrag(e) {\n\n      var diff = prev_y - e.clientY;\n      _this.setValue(_this.getValue() + diff * _this.__impliedStep);\n\n      prev_y = e.clientY;\n\n    }\n\n    function onMouseUp() {\n      dom.unbind(window, 'mousemove', onMouseDrag);\n      dom.unbind(window, 'mouseup', onMouseUp);\n    }\n\n    this.updateDisplay();\n\n    this.domElement.appendChild(this.__input);\n\n  };\n\n  NumberControllerBox.superclass = NumberController;\n\n  common.extend(\n\n      NumberControllerBox.prototype,\n      NumberController.prototype,\n\n      {\n\n        updateDisplay: function() {\n\n          this.__input.value = this.__truncationSuspended ? this.getValue() : roundToDecimal(this.getValue(), this.__precision);\n          return NumberControllerBox.superclass.prototype.updateDisplay.call(this);\n        }\n\n      }\n\n  );\n\n  function roundToDecimal(value, decimals) {\n    var tenTo = Math.pow(10, decimals);\n    return Math.round(value * tenTo) / tenTo;\n  }\n\n  return NumberControllerBox;\n\n})(dat.controllers.NumberController,\ndat.dom.dom,\ndat.utils.common);\n\n\ndat.controllers.NumberControllerSlider = (function (NumberController, dom, css, common, styleSheet) {\n\n  /**\n   * @class Represents a given property of an object that is a number, contains\n   * a minimum and maximum, and provides a slider element with which to\n   * manipulate it. It should be noted that the slider element is made up of\n   * <code>&lt;div&gt;</code> tags, <strong>not</strong> the html5\n   * <code>&lt;slider&gt;</code> element.\n   *\n   * @extends dat.controllers.Controller\n   * @extends dat.controllers.NumberController\n   * \n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   * @param {Number} minValue Minimum allowed value\n   * @param {Number} maxValue Maximum allowed value\n   * @param {Number} stepValue Increment by which to change value\n   *\n   * @member dat.controllers\n   */\n  var NumberControllerSlider = function(object, property, min, max, step) {\n\n    NumberControllerSlider.superclass.call(this, object, property, { min: min, max: max, step: step });\n\n    var _this = this;\n\n    this.__background = document.createElement('div');\n    this.__foreground = document.createElement('div');\n    \n\n\n    dom.bind(this.__background, 'mousedown', onMouseDown);\n    \n    dom.addClass(this.__background, 'slider');\n    dom.addClass(this.__foreground, 'slider-fg');\n\n    function onMouseDown(e) {\n\n      dom.bind(window, 'mousemove', onMouseDrag);\n      dom.bind(window, 'mouseup', onMouseUp);\n\n      onMouseDrag(e);\n    }\n\n    function onMouseDrag(e) {\n\n      e.preventDefault();\n\n      var offset = dom.getOffset(_this.__background);\n      var width = dom.getWidth(_this.__background);\n      \n      _this.setValue(\n        map(e.clientX, offset.left, offset.left + width, _this.__min, _this.__max)\n      );\n\n      return false;\n\n    }\n\n    function onMouseUp() {\n      dom.unbind(window, 'mousemove', onMouseDrag);\n      dom.unbind(window, 'mouseup', onMouseUp);\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    this.updateDisplay();\n\n    this.__background.appendChild(this.__foreground);\n    this.domElement.appendChild(this.__background);\n\n  };\n\n  NumberControllerSlider.superclass = NumberController;\n\n  /**\n   * Injects default stylesheet for slider elements.\n   */\n  NumberControllerSlider.useDefaultStyles = function() {\n    css.inject(styleSheet);\n  };\n\n  common.extend(\n\n      NumberControllerSlider.prototype,\n      NumberController.prototype,\n\n      {\n\n        updateDisplay: function() {\n          var pct = (this.getValue() - this.__min)/(this.__max - this.__min);\n          this.__foreground.style.width = pct*100+'%';\n          return NumberControllerSlider.superclass.prototype.updateDisplay.call(this);\n        }\n\n      }\n\n\n\n  );\n\n  function map(v, i1, i2, o1, o2) {\n    return o1 + (o2 - o1) * ((v - i1) / (i2 - i1));\n  }\n\n  return NumberControllerSlider;\n  \n})(dat.controllers.NumberController,\ndat.dom.dom,\ndat.utils.css,\ndat.utils.common,\n\".slider {\\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\\n  height: 1em;\\n  border-radius: 1em;\\n  background-color: #eee;\\n  padding: 0 0.5em;\\n  overflow: hidden;\\n}\\n\\n.slider-fg {\\n  padding: 1px 0 2px 0;\\n  background-color: #aaa;\\n  height: 1em;\\n  margin-left: -0.5em;\\n  padding-right: 0.5em;\\n  border-radius: 1em 0 0 1em;\\n}\\n\\n.slider-fg:after {\\n  display: inline-block;\\n  border-radius: 1em;\\n  background-color: #fff;\\n  border:  1px solid #aaa;\\n  content: '';\\n  float: right;\\n  margin-right: -1em;\\n  margin-top: -1px;\\n  height: 0.9em;\\n  width: 0.9em;\\n}\");\n\n\ndat.controllers.FunctionController = (function (Controller, dom, common) {\n\n  /**\n   * @class Provides a GUI interface to fire a specified method, a property of an object.\n   *\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   *\n   * @member dat.controllers\n   */\n  var FunctionController = function(object, property, text) {\n\n    FunctionController.superclass.call(this, object, property);\n\n    var _this = this;\n\n    this.__button = document.createElement('div');\n    this.__button.innerHTML = text === undefined ? 'Fire' : text;\n    dom.bind(this.__button, 'click', function(e) {\n      e.preventDefault();\n      _this.fire();\n      return false;\n    });\n\n    dom.addClass(this.__button, 'button');\n\n    this.domElement.appendChild(this.__button);\n\n\n  };\n\n  FunctionController.superclass = Controller;\n\n  common.extend(\n\n      FunctionController.prototype,\n      Controller.prototype,\n      {\n        \n        fire: function() {\n          if (this.__onChange) {\n            this.__onChange.call(this);\n          }\n          if (this.__onFinishChange) {\n            this.__onFinishChange.call(this, this.getValue());\n          }\n          this.getValue().call(this.object);\n        }\n      }\n\n  );\n\n  return FunctionController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.utils.common);\n\n\ndat.controllers.BooleanController = (function (Controller, dom, common) {\n\n  /**\n   * @class Provides a checkbox input to alter the boolean property of an object.\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   *\n   * @member dat.controllers\n   */\n  var BooleanController = function(object, property) {\n\n    BooleanController.superclass.call(this, object, property);\n\n    var _this = this;\n    this.__prev = this.getValue();\n\n    this.__checkbox = document.createElement('input');\n    this.__checkbox.setAttribute('type', 'checkbox');\n\n\n    dom.bind(this.__checkbox, 'change', onChange, false);\n\n    this.domElement.appendChild(this.__checkbox);\n\n    // Match original value\n    this.updateDisplay();\n\n    function onChange() {\n      _this.setValue(!_this.__prev);\n    }\n\n  };\n\n  BooleanController.superclass = Controller;\n\n  common.extend(\n\n      BooleanController.prototype,\n      Controller.prototype,\n\n      {\n\n        setValue: function(v) {\n          var toReturn = BooleanController.superclass.prototype.setValue.call(this, v);\n          if (this.__onFinishChange) {\n            this.__onFinishChange.call(this, this.getValue());\n          }\n          this.__prev = this.getValue();\n          return toReturn;\n        },\n\n        updateDisplay: function() {\n          \n          if (this.getValue() === true) {\n            this.__checkbox.setAttribute('checked', 'checked');\n            this.__checkbox.checked = true;    \n          } else {\n              this.__checkbox.checked = false;\n          }\n\n          return BooleanController.superclass.prototype.updateDisplay.call(this);\n\n        }\n\n\n      }\n\n  );\n\n  return BooleanController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.utils.common);\n\n\ndat.color.toString = (function (common) {\n\n  return function(color) {\n\n    if (color.a == 1 || common.isUndefined(color.a)) {\n\n      var s = color.hex.toString(16);\n      while (s.length < 6) {\n        s = '0' + s;\n      }\n\n      return '#' + s;\n\n    } else {\n\n      return 'rgba(' + Math.round(color.r) + ',' + Math.round(color.g) + ',' + Math.round(color.b) + ',' + color.a + ')';\n\n    }\n\n  }\n\n})(dat.utils.common);\n\n\ndat.color.interpret = (function (toString, common) {\n\n  var result, toReturn;\n\n  var interpret = function() {\n\n    toReturn = false;\n\n    var original = arguments.length > 1 ? common.toArray(arguments) : arguments[0];\n\n    common.each(INTERPRETATIONS, function(family) {\n\n      if (family.litmus(original)) {\n\n        common.each(family.conversions, function(conversion, conversionName) {\n\n          result = conversion.read(original);\n\n          if (toReturn === false && result !== false) {\n            toReturn = result;\n            result.conversionName = conversionName;\n            result.conversion = conversion;\n            return common.BREAK;\n\n          }\n\n        });\n\n        return common.BREAK;\n\n      }\n\n    });\n\n    return toReturn;\n\n  };\n\n  var INTERPRETATIONS = [\n\n    // Strings\n    {\n\n      litmus: common.isString,\n\n      conversions: {\n\n        THREE_CHAR_HEX: {\n\n          read: function(original) {\n\n            var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\n            if (test === null) return false;\n\n            return {\n              space: 'HEX',\n              hex: parseInt(\n                  '0x' +\n                      test[1].toString() + test[1].toString() +\n                      test[2].toString() + test[2].toString() +\n                      test[3].toString() + test[3].toString())\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        SIX_CHAR_HEX: {\n\n          read: function(original) {\n\n            var test = original.match(/^#([A-F0-9]{6})$/i);\n            if (test === null) return false;\n\n            return {\n              space: 'HEX',\n              hex: parseInt('0x' + test[1].toString())\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        CSS_RGB: {\n\n          read: function(original) {\n\n            var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\n            if (test === null) return false;\n\n            return {\n              space: 'RGB',\n              r: parseFloat(test[1]),\n              g: parseFloat(test[2]),\n              b: parseFloat(test[3])\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        CSS_RGBA: {\n\n          read: function(original) {\n\n            var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\,\\s*(.+)\\s*\\)/);\n            if (test === null) return false;\n\n            return {\n              space: 'RGB',\n              r: parseFloat(test[1]),\n              g: parseFloat(test[2]),\n              b: parseFloat(test[3]),\n              a: parseFloat(test[4])\n            };\n\n          },\n\n          write: toString\n\n        }\n\n      }\n\n    },\n\n    // Numbers\n    {\n\n      litmus: common.isNumber,\n\n      conversions: {\n\n        HEX: {\n          read: function(original) {\n            return {\n              space: 'HEX',\n              hex: original,\n              conversionName: 'HEX'\n            }\n          },\n\n          write: function(color) {\n            return color.hex;\n          }\n        }\n\n      }\n\n    },\n\n    // Arrays\n    {\n\n      litmus: common.isArray,\n\n      conversions: {\n\n        RGB_ARRAY: {\n          read: function(original) {\n            if (original.length != 3) return false;\n            return {\n              space: 'RGB',\n              r: original[0],\n              g: original[1],\n              b: original[2]\n            };\n          },\n\n          write: function(color) {\n            return [color.r, color.g, color.b];\n          }\n\n        },\n\n        RGBA_ARRAY: {\n          read: function(original) {\n            if (original.length != 4) return false;\n            return {\n              space: 'RGB',\n              r: original[0],\n              g: original[1],\n              b: original[2],\n              a: original[3]\n            };\n          },\n\n          write: function(color) {\n            return [color.r, color.g, color.b, color.a];\n          }\n\n        }\n\n      }\n\n    },\n\n    // Objects\n    {\n\n      litmus: common.isObject,\n\n      conversions: {\n\n        RGBA_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.r) &&\n                common.isNumber(original.g) &&\n                common.isNumber(original.b) &&\n                common.isNumber(original.a)) {\n              return {\n                space: 'RGB',\n                r: original.r,\n                g: original.g,\n                b: original.b,\n                a: original.a\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              r: color.r,\n              g: color.g,\n              b: color.b,\n              a: color.a\n            }\n          }\n        },\n\n        RGB_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.r) &&\n                common.isNumber(original.g) &&\n                common.isNumber(original.b)) {\n              return {\n                space: 'RGB',\n                r: original.r,\n                g: original.g,\n                b: original.b\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              r: color.r,\n              g: color.g,\n              b: color.b\n            }\n          }\n        },\n\n        HSVA_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.h) &&\n                common.isNumber(original.s) &&\n                common.isNumber(original.v) &&\n                common.isNumber(original.a)) {\n              return {\n                space: 'HSV',\n                h: original.h,\n                s: original.s,\n                v: original.v,\n                a: original.a\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              h: color.h,\n              s: color.s,\n              v: color.v,\n              a: color.a\n            }\n          }\n        },\n\n        HSV_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.h) &&\n                common.isNumber(original.s) &&\n                common.isNumber(original.v)) {\n              return {\n                space: 'HSV',\n                h: original.h,\n                s: original.s,\n                v: original.v\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              h: color.h,\n              s: color.s,\n              v: color.v\n            }\n          }\n\n        }\n\n      }\n\n    }\n\n\n  ];\n\n  return interpret;\n\n\n})(dat.color.toString,\ndat.utils.common);\n\n\ndat.GUI = dat.gui.GUI = (function (css, saveDialogueContents, styleSheet, controllerFactory, Controller, BooleanController, FunctionController, NumberControllerBox, NumberControllerSlider, OptionController, ColorController, requestAnimationFrame, CenteredDiv, dom, common) {\n\n  css.inject(styleSheet);\n\n  /** Outer-most className for GUI's */\n  var CSS_NAMESPACE = 'dg';\n\n  var HIDE_KEY_CODE = 72;\n\n  /** The only value shared between the JS and SCSS. Use caution. */\n  var CLOSE_BUTTON_HEIGHT = 20;\n\n  var DEFAULT_DEFAULT_PRESET_NAME = 'Default';\n\n  var SUPPORTS_LOCAL_STORAGE = (function() {\n    try {\n      return 'localStorage' in window && window['localStorage'] !== null;\n    } catch (e) {\n      return false;\n    }\n  })();\n\n  var SAVE_DIALOGUE;\n\n  /** Have we yet to create an autoPlace GUI? */\n  var auto_place_virgin = true;\n\n  /** Fixed position div that auto place GUI's go inside */\n  var auto_place_container;\n\n  /** Are we hiding the GUI's ? */\n  var hide = false;\n\n  /** GUI's which should be hidden */\n  var hideable_guis = [];\n\n  /**\n   * A lightweight controller library for JavaScript. It allows you to easily\n   * manipulate variables and fire functions on the fly.\n   * @class\n   *\n   * @member dat.gui\n   *\n   * @param {Object} [params]\n   * @param {String} [params.name] The name of this GUI.\n   * @param {Object} [params.load] JSON object representing the saved state of\n   * this GUI.\n   * @param {Boolean} [params.auto=true]\n   * @param {dat.gui.GUI} [params.parent] The GUI I'm nested in.\n   * @param {Boolean} [params.closed] If true, starts closed\n   */\n  var GUI = function(params) {\n\n    var _this = this;\n\n    /**\n     * Outermost DOM Element\n     * @type DOMElement\n     */\n    this.domElement = document.createElement('div');\n    this.__ul = document.createElement('ul');\n    this.domElement.appendChild(this.__ul);\n\n    dom.addClass(this.domElement, CSS_NAMESPACE);\n\n    /**\n     * Nested GUI's by name\n     * @ignore\n     */\n    this.__folders = {};\n\n    this.__controllers = [];\n\n    /**\n     * List of objects I'm remembering for save, only used in top level GUI\n     * @ignore\n     */\n    this.__rememberedObjects = [];\n\n    /**\n     * Maps the index of remembered objects to a map of controllers, only used\n     * in top level GUI.\n     *\n     * @private\n     * @ignore\n     *\n     * @example\n     * [\n     *  {\n     *    propertyName: Controller,\n     *    anotherPropertyName: Controller\n     *  },\n     *  {\n     *    propertyName: Controller\n     *  }\n     * ]\n     */\n    this.__rememberedObjectIndecesToControllers = [];\n\n    this.__listening = [];\n\n    params = params || {};\n\n    // Default parameters\n    params = common.defaults(params, {\n      autoPlace: true,\n      width: GUI.DEFAULT_WIDTH\n    });\n\n    params = common.defaults(params, {\n      resizable: params.autoPlace,\n      hideable: params.autoPlace\n    });\n\n\n    if (!common.isUndefined(params.load)) {\n\n      // Explicit preset\n      if (params.preset) params.load.preset = params.preset;\n\n    } else {\n\n      params.load = { preset: DEFAULT_DEFAULT_PRESET_NAME };\n\n    }\n\n    if (common.isUndefined(params.parent) && params.hideable) {\n      hideable_guis.push(this);\n    }\n\n    // Only root level GUI's are resizable.\n    params.resizable = common.isUndefined(params.parent) && params.resizable;\n\n\n    if (params.autoPlace && common.isUndefined(params.scrollable)) {\n      params.scrollable = true;\n    }\n//    params.scrollable = common.isUndefined(params.parent) && params.scrollable === true;\n\n    // Not part of params because I don't want people passing this in via\n    // constructor. Should be a 'remembered' value.\n    var use_local_storage =\n        SUPPORTS_LOCAL_STORAGE &&\n            localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';\n\n    Object.defineProperties(this,\n\n        /** @lends dat.gui.GUI.prototype */\n        {\n\n          /**\n           * The parent <code>GUI</code>\n           * @type dat.gui.GUI\n           */\n          parent: {\n            get: function() {\n              return params.parent;\n            }\n          },\n\n          scrollable: {\n            get: function() {\n              return params.scrollable;\n            }\n          },\n\n          /**\n           * Handles <code>GUI</code>'s element placement for you\n           * @type Boolean\n           */\n          autoPlace: {\n            get: function() {\n              return params.autoPlace;\n            }\n          },\n\n          /**\n           * The identifier for a set of saved values\n           * @type String\n           */\n          preset: {\n\n            get: function() {\n              if (_this.parent) {\n                return _this.getRoot().preset;\n              } else {\n                return params.load.preset;\n              }\n            },\n\n            set: function(v) {\n              if (_this.parent) {\n                _this.getRoot().preset = v;\n              } else {\n                params.load.preset = v;\n              }\n              setPresetSelectIndex(this);\n              _this.revert();\n            }\n\n          },\n\n          /**\n           * The width of <code>GUI</code> element\n           * @type Number\n           */\n          width: {\n            get: function() {\n              return params.width;\n            },\n            set: function(v) {\n              params.width = v;\n              setWidth(_this, v);\n            }\n          },\n\n          /**\n           * The name of <code>GUI</code>. Used for folders. i.e\n           * a folder's name\n           * @type String\n           */\n          name: {\n            get: function() {\n              return params.name;\n            },\n            set: function(v) {\n              // TODO Check for collisions among sibling folders\n              params.name = v;\n              if (title_row_name) {\n                title_row_name.innerHTML = params.name;\n              }\n            }\n          },\n\n          /**\n           * Whether the <code>GUI</code> is collapsed or not\n           * @type Boolean\n           */\n          closed: {\n            get: function() {\n              return params.closed;\n            },\n            set: function(v) {\n              params.closed = v;\n              if (params.closed) {\n                dom.addClass(_this.__ul, GUI.CLASS_CLOSED);\n              } else {\n                dom.removeClass(_this.__ul, GUI.CLASS_CLOSED);\n              }\n              // For browsers that aren't going to respect the CSS transition,\n              // Lets just check our height against the window height right off\n              // the bat.\n              this.onResize();\n\n              if (_this.__closeButton) {\n                _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;\n              }\n            }\n          },\n\n          /**\n           * Contains all presets\n           * @type Object\n           */\n          load: {\n            get: function() {\n              return params.load;\n            }\n          },\n\n          /**\n           * Determines whether or not to use <a href=\"https://developer.mozilla.org/en/DOM/Storage#localStorage\">localStorage</a> as the means for\n           * <code>remember</code>ing\n           * @type Boolean\n           */\n          useLocalStorage: {\n\n            get: function() {\n              return use_local_storage;\n            },\n            set: function(bool) {\n              if (SUPPORTS_LOCAL_STORAGE) {\n                use_local_storage = bool;\n                if (bool) {\n                  dom.bind(window, 'unload', saveToLocalStorage);\n                } else {\n                  dom.unbind(window, 'unload', saveToLocalStorage);\n                }\n                localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);\n              }\n            }\n\n          }\n\n        });\n\n    // Are we a root level GUI?\n    if (common.isUndefined(params.parent)) {\n\n      params.closed = false;\n\n      dom.addClass(this.domElement, GUI.CLASS_MAIN);\n      dom.makeSelectable(this.domElement, false);\n\n      // Are we supposed to be loading locally?\n      if (SUPPORTS_LOCAL_STORAGE) {\n\n        if (use_local_storage) {\n\n          _this.useLocalStorage = true;\n\n          var saved_gui = localStorage.getItem(getLocalStorageHash(this, 'gui'));\n\n          if (saved_gui) {\n            params.load = JSON.parse(saved_gui);\n          }\n\n        }\n\n      }\n\n      this.__closeButton = document.createElement('div');\n      this.__closeButton.innerHTML = GUI.TEXT_CLOSED;\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);\n      this.domElement.appendChild(this.__closeButton);\n\n      dom.bind(this.__closeButton, 'click', function() {\n\n        _this.closed = !_this.closed;\n\n\n      });\n\n\n      // Oh, you're a nested GUI!\n    } else {\n\n      if (params.closed === undefined) {\n        params.closed = true;\n      }\n\n      var title_row_name = document.createTextNode(params.name);\n      dom.addClass(title_row_name, 'controller-name');\n\n      var title_row = addRow(_this, title_row_name);\n\n      var on_click_title = function(e) {\n        e.preventDefault();\n        _this.closed = !_this.closed;\n        return false;\n      };\n\n      dom.addClass(this.__ul, GUI.CLASS_CLOSED);\n\n      dom.addClass(title_row, 'title');\n      dom.bind(title_row, 'click', on_click_title);\n\n      if (!params.closed) {\n        this.closed = false;\n      }\n\n    }\n\n    if (params.autoPlace) {\n\n      if (common.isUndefined(params.parent)) {\n\n        if (auto_place_virgin) {\n          auto_place_container = document.createElement('div');\n          dom.addClass(auto_place_container, CSS_NAMESPACE);\n          dom.addClass(auto_place_container, GUI.CLASS_AUTO_PLACE_CONTAINER);\n          document.body.appendChild(auto_place_container);\n          auto_place_virgin = false;\n        }\n\n        // Put it in the dom for you.\n        auto_place_container.appendChild(this.domElement);\n\n        // Apply the auto styles\n        dom.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);\n\n      }\n\n\n      // Make it not elastic.\n      if (!this.parent) setWidth(_this, params.width);\n\n    }\n\n    dom.bind(window, 'resize', function() { _this.onResize() });\n    dom.bind(this.__ul, 'webkitTransitionEnd', function() { _this.onResize(); });\n    dom.bind(this.__ul, 'transitionend', function() { _this.onResize() });\n    dom.bind(this.__ul, 'oTransitionEnd', function() { _this.onResize() });\n    this.onResize();\n\n\n    if (params.resizable) {\n      addResizeHandle(this);\n    }\n\n    function saveToLocalStorage() {\n      localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));\n    }\n\n    var root = _this.getRoot();\n    function resetWidth() {\n        var root = _this.getRoot();\n        root.width += 1;\n        common.defer(function() {\n          root.width -= 1;\n        });\n      }\n\n      if (!params.parent) {\n        resetWidth();\n      }\n\n  };\n\n  GUI.toggleHide = function() {\n\n    hide = !hide;\n    common.each(hideable_guis, function(gui) {\n      gui.domElement.style.zIndex = hide ? -999 : 999;\n      gui.domElement.style.opacity = hide ? 0 : 1;\n    });\n  };\n\n  GUI.CLASS_AUTO_PLACE = 'a';\n  GUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';\n  GUI.CLASS_MAIN = 'main';\n  GUI.CLASS_CONTROLLER_ROW = 'cr';\n  GUI.CLASS_TOO_TALL = 'taller-than-window';\n  GUI.CLASS_CLOSED = 'closed';\n  GUI.CLASS_CLOSE_BUTTON = 'close-button';\n  GUI.CLASS_DRAG = 'drag';\n\n  GUI.DEFAULT_WIDTH = 245;\n  GUI.TEXT_CLOSED = 'Close Controls';\n  GUI.TEXT_OPEN = 'Open Controls';\n\n  dom.bind(window, 'keydown', function(e) {\n\n    if (document.activeElement.type !== 'text' &&\n        (e.which === HIDE_KEY_CODE || e.keyCode == HIDE_KEY_CODE)) {\n      GUI.toggleHide();\n    }\n\n  }, false);\n\n  common.extend(\n\n      GUI.prototype,\n\n      /** @lends dat.gui.GUI */\n      {\n\n        /**\n         * @param object\n         * @param property\n         * @returns {dat.controllers.Controller} The new controller that was added.\n         * @instance\n         */\n        add: function(object, property) {\n\n          return add(\n              this,\n              object,\n              property,\n              {\n                factoryArgs: Array.prototype.slice.call(arguments, 2)\n              }\n          );\n\n        },\n\n        /**\n         * @param object\n         * @param property\n         * @returns {dat.controllers.ColorController} The new controller that was added.\n         * @instance\n         */\n        addColor: function(object, property) {\n\n          return add(\n              this,\n              object,\n              property,\n              {\n                color: true\n              }\n          );\n\n        },\n\n        /**\n         * @param controller\n         * @instance\n         */\n        remove: function(controller) {\n\n          // TODO listening?\n          this.__ul.removeChild(controller.__li);\n          this.__controllers.slice(this.__controllers.indexOf(controller), 1);\n          var _this = this;\n          common.defer(function() {\n            _this.onResize();\n          });\n\n        },\n\n        destroy: function() {\n\n          if (this.autoPlace) {\n            auto_place_container.removeChild(this.domElement);\n          }\n\n        },\n\n        /**\n         * @param name\n         * @returns {dat.gui.GUI} The new folder.\n         * @throws {Error} if this GUI already has a folder by the specified\n         * name\n         * @instance\n         */\n        addFolder: function(name) {\n\n          // We have to prevent collisions on names in order to have a key\n          // by which to remember saved values\n          if (this.__folders[name] !== undefined) {\n            throw new Error('You already have a folder in this GUI by the' +\n                ' name \"' + name + '\"');\n          }\n\n          var new_gui_params = { name: name, parent: this };\n\n          // We need to pass down the autoPlace trait so that we can\n          // attach event listeners to open/close folder actions to\n          // ensure that a scrollbar appears if the window is too short.\n          new_gui_params.autoPlace = this.autoPlace;\n\n          // Do we have saved appearance data for this folder?\n\n          if (this.load && // Anything loaded?\n              this.load.folders && // Was my parent a dead-end?\n              this.load.folders[name]) { // Did daddy remember me?\n\n            // Start me closed if I was closed\n            new_gui_params.closed = this.load.folders[name].closed;\n\n            // Pass down the loaded data\n            new_gui_params.load = this.load.folders[name];\n\n          }\n\n          var gui = new GUI(new_gui_params);\n          this.__folders[name] = gui;\n\n          var li = addRow(this, gui.domElement);\n          dom.addClass(li, 'folder');\n          return gui;\n\n        },\n\n        open: function() {\n          this.closed = false;\n        },\n\n        close: function() {\n          this.closed = true;\n        },\n\n        onResize: function() {\n\n          var root = this.getRoot();\n\n          if (root.scrollable) {\n\n            var top = dom.getOffset(root.__ul).top;\n            var h = 0;\n\n            common.each(root.__ul.childNodes, function(node) {\n              if (! (root.autoPlace && node === root.__save_row))\n                h += dom.getHeight(node);\n            });\n\n            if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {\n              dom.addClass(root.domElement, GUI.CLASS_TOO_TALL);\n              root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';\n            } else {\n              dom.removeClass(root.domElement, GUI.CLASS_TOO_TALL);\n              root.__ul.style.height = 'auto';\n            }\n\n          }\n\n          if (root.__resize_handle) {\n            common.defer(function() {\n              root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';\n            });\n          }\n\n          if (root.__closeButton) {\n            root.__closeButton.style.width = root.width + 'px';\n          }\n\n        },\n\n        /**\n         * Mark objects for saving. The order of these objects cannot change as\n         * the GUI grows. When remembering new objects, append them to the end\n         * of the list.\n         *\n         * @param {Object...} objects\n         * @throws {Error} if not called on a top level GUI.\n         * @instance\n         */\n        remember: function() {\n\n          if (common.isUndefined(SAVE_DIALOGUE)) {\n            SAVE_DIALOGUE = new CenteredDiv();\n            SAVE_DIALOGUE.domElement.innerHTML = saveDialogueContents;\n          }\n\n          if (this.parent) {\n            throw new Error(\"You can only call remember on a top level GUI.\");\n          }\n\n          var _this = this;\n\n          common.each(Array.prototype.slice.call(arguments), function(object) {\n            if (_this.__rememberedObjects.length == 0) {\n              addSaveMenu(_this);\n            }\n            if (_this.__rememberedObjects.indexOf(object) == -1) {\n              _this.__rememberedObjects.push(object);\n            }\n          });\n\n          if (this.autoPlace) {\n            // Set save row width\n            setWidth(this, this.width);\n          }\n\n        },\n\n        /**\n         * @returns {dat.gui.GUI} the topmost parent GUI of a nested GUI.\n         * @instance\n         */\n        getRoot: function() {\n          var gui = this;\n          while (gui.parent) {\n            gui = gui.parent;\n          }\n          return gui;\n        },\n\n        /**\n         * @returns {Object} a JSON object representing the current state of\n         * this GUI as well as its remembered properties.\n         * @instance\n         */\n        getSaveObject: function() {\n\n          var toReturn = this.load;\n\n          toReturn.closed = this.closed;\n\n          // Am I remembering any values?\n          if (this.__rememberedObjects.length > 0) {\n\n            toReturn.preset = this.preset;\n\n            if (!toReturn.remembered) {\n              toReturn.remembered = {};\n            }\n\n            toReturn.remembered[this.preset] = getCurrentPreset(this);\n\n          }\n\n          toReturn.folders = {};\n          common.each(this.__folders, function(element, key) {\n            toReturn.folders[key] = element.getSaveObject();\n          });\n\n          return toReturn;\n\n        },\n\n        save: function() {\n\n          if (!this.load.remembered) {\n            this.load.remembered = {};\n          }\n\n          this.load.remembered[this.preset] = getCurrentPreset(this);\n          markPresetModified(this, false);\n\n        },\n\n        saveAs: function(presetName) {\n\n          if (!this.load.remembered) {\n\n            // Retain default values upon first save\n            this.load.remembered = {};\n            this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);\n\n          }\n\n          this.load.remembered[presetName] = getCurrentPreset(this);\n          this.preset = presetName;\n          addPresetOption(this, presetName, true);\n\n        },\n\n        revert: function(gui) {\n\n          common.each(this.__controllers, function(controller) {\n            // Make revert work on Default.\n            if (!this.getRoot().load.remembered) {\n              controller.setValue(controller.initialValue);\n            } else {\n              recallSavedValue(gui || this.getRoot(), controller);\n            }\n          }, this);\n\n          common.each(this.__folders, function(folder) {\n            folder.revert(folder);\n          });\n\n          if (!gui) {\n            markPresetModified(this.getRoot(), false);\n          }\n\n\n        },\n\n        listen: function(controller) {\n\n          var init = this.__listening.length == 0;\n          this.__listening.push(controller);\n          if (init) updateDisplays(this.__listening);\n\n        }\n\n      }\n\n  );\n\n  function add(gui, object, property, params) {\n\n    if (object[property] === undefined) {\n      throw new Error(\"Object \" + object + \" has no property \\\"\" + property + \"\\\"\");\n    }\n\n    var controller;\n\n    if (params.color) {\n\n      controller = new ColorController(object, property);\n\n    } else {\n\n      var factoryArgs = [object,property].concat(params.factoryArgs);\n      controller = controllerFactory.apply(gui, factoryArgs);\n\n    }\n\n    if (params.before instanceof Controller) {\n      params.before = params.before.__li;\n    }\n\n    recallSavedValue(gui, controller);\n\n    dom.addClass(controller.domElement, 'c');\n\n    var name = document.createElement('span');\n    dom.addClass(name, 'property-name');\n    name.innerHTML = controller.property;\n\n    var container = document.createElement('div');\n    container.appendChild(name);\n    container.appendChild(controller.domElement);\n\n    var li = addRow(gui, container, params.before);\n\n    dom.addClass(li, GUI.CLASS_CONTROLLER_ROW);\n    dom.addClass(li, typeof controller.getValue());\n\n    augmentController(gui, li, controller);\n\n    gui.__controllers.push(controller);\n\n    return controller;\n\n  }\n\n  /**\n   * Add a row to the end of the GUI or before another row.\n   *\n   * @param gui\n   * @param [dom] If specified, inserts the dom content in the new row\n   * @param [liBefore] If specified, places the new row before another row\n   */\n  function addRow(gui, dom, liBefore) {\n    var li = document.createElement('li');\n    if (dom) li.appendChild(dom);\n    if (liBefore) {\n      gui.__ul.insertBefore(li, params.before);\n    } else {\n      gui.__ul.appendChild(li);\n    }\n    gui.onResize();\n    return li;\n  }\n\n  function augmentController(gui, li, controller) {\n\n    controller.__li = li;\n    controller.__gui = gui;\n\n    common.extend(controller, {\n\n      options: function(options) {\n\n        if (arguments.length > 1) {\n          controller.remove();\n\n          return add(\n              gui,\n              controller.object,\n              controller.property,\n              {\n                before: controller.__li.nextElementSibling,\n                factoryArgs: [common.toArray(arguments)]\n              }\n          );\n\n        }\n\n        if (common.isArray(options) || common.isObject(options)) {\n          controller.remove();\n\n          return add(\n              gui,\n              controller.object,\n              controller.property,\n              {\n                before: controller.__li.nextElementSibling,\n                factoryArgs: [options]\n              }\n          );\n\n        }\n\n      },\n\n      name: function(v) {\n        controller.__li.firstElementChild.firstElementChild.innerHTML = v;\n        return controller;\n      },\n\n      listen: function() {\n        controller.__gui.listen(controller);\n        return controller;\n      },\n\n      remove: function() {\n        controller.__gui.remove(controller);\n        return controller;\n      }\n\n    });\n\n    // All sliders should be accompanied by a box.\n    if (controller instanceof NumberControllerSlider) {\n\n      var box = new NumberControllerBox(controller.object, controller.property,\n          { min: controller.__min, max: controller.__max, step: controller.__step });\n\n      common.each(['updateDisplay', 'onChange', 'onFinishChange'], function(method) {\n        var pc = controller[method];\n        var pb = box[method];\n        controller[method] = box[method] = function() {\n          var args = Array.prototype.slice.call(arguments);\n          pc.apply(controller, args);\n          return pb.apply(box, args);\n        }\n      });\n\n      dom.addClass(li, 'has-slider');\n      controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);\n\n    }\n    else if (controller instanceof NumberControllerBox) {\n\n      var r = function(returned) {\n\n        // Have we defined both boundaries?\n        if (common.isNumber(controller.__min) && common.isNumber(controller.__max)) {\n\n          // Well, then lets just replace this with a slider.\n          controller.remove();\n          return add(\n              gui,\n              controller.object,\n              controller.property,\n              {\n                before: controller.__li.nextElementSibling,\n                factoryArgs: [controller.__min, controller.__max, controller.__step]\n              });\n\n        }\n\n        return returned;\n\n      };\n\n      controller.min = common.compose(r, controller.min);\n      controller.max = common.compose(r, controller.max);\n\n    }\n    else if (controller instanceof BooleanController) {\n\n      dom.bind(li, 'click', function() {\n        dom.fakeEvent(controller.__checkbox, 'click');\n      });\n\n      dom.bind(controller.__checkbox, 'click', function(e) {\n        e.stopPropagation(); // Prevents double-toggle\n      })\n\n    }\n    else if (controller instanceof FunctionController) {\n\n      dom.bind(li, 'click', function() {\n        dom.fakeEvent(controller.__button, 'click');\n      });\n\n      dom.bind(li, 'mouseover', function() {\n        dom.addClass(controller.__button, 'hover');\n      });\n\n      dom.bind(li, 'mouseout', function() {\n        dom.removeClass(controller.__button, 'hover');\n      });\n\n    }\n    else if (controller instanceof ColorController) {\n\n      dom.addClass(li, 'color');\n      controller.updateDisplay = common.compose(function(r) {\n        li.style.borderLeftColor = controller.__color.toString();\n        return r;\n      }, controller.updateDisplay);\n\n      controller.updateDisplay();\n\n    }\n\n    controller.setValue = common.compose(function(r) {\n      if (gui.getRoot().__preset_select && controller.isModified()) {\n        markPresetModified(gui.getRoot(), true);\n      }\n      return r;\n    }, controller.setValue);\n\n  }\n\n  function recallSavedValue(gui, controller) {\n\n    // Find the topmost GUI, that's where remembered objects live.\n    var root = gui.getRoot();\n\n    // Does the object we're controlling match anything we've been told to\n    // remember?\n    var matched_index = root.__rememberedObjects.indexOf(controller.object);\n\n    // Why yes, it does!\n    if (matched_index != -1) {\n\n      // Let me fetch a map of controllers for thcommon.isObject.\n      var controller_map =\n          root.__rememberedObjectIndecesToControllers[matched_index];\n\n      // Ohp, I believe this is the first controller we've created for this\n      // object. Lets make the map fresh.\n      if (controller_map === undefined) {\n        controller_map = {};\n        root.__rememberedObjectIndecesToControllers[matched_index] =\n            controller_map;\n      }\n\n      // Keep track of this controller\n      controller_map[controller.property] = controller;\n\n      // Okay, now have we saved any values for this controller?\n      if (root.load && root.load.remembered) {\n\n        var preset_map = root.load.remembered;\n\n        // Which preset are we trying to load?\n        var preset;\n\n        if (preset_map[gui.preset]) {\n\n          preset = preset_map[gui.preset];\n\n        } else if (preset_map[DEFAULT_DEFAULT_PRESET_NAME]) {\n\n          // Uhh, you can have the default instead?\n          preset = preset_map[DEFAULT_DEFAULT_PRESET_NAME];\n\n        } else {\n\n          // Nada.\n\n          return;\n\n        }\n\n\n        // Did the loaded object remember thcommon.isObject?\n        if (preset[matched_index] &&\n\n          // Did we remember this particular property?\n            preset[matched_index][controller.property] !== undefined) {\n\n          // We did remember something for this guy ...\n          var value = preset[matched_index][controller.property];\n\n          // And that's what it is.\n          controller.initialValue = value;\n          controller.setValue(value);\n\n        }\n\n      }\n\n    }\n\n  }\n\n  function getLocalStorageHash(gui, key) {\n    // TODO how does this deal with multiple GUI's?\n    return document.location.href + '.' + key;\n\n  }\n\n  function addSaveMenu(gui) {\n\n    var div = gui.__save_row = document.createElement('li');\n\n    dom.addClass(gui.domElement, 'has-save');\n\n    gui.__ul.insertBefore(div, gui.__ul.firstChild);\n\n    dom.addClass(div, 'save-row');\n\n    var gears = document.createElement('span');\n    gears.innerHTML = '&nbsp;';\n    dom.addClass(gears, 'button gears');\n\n    // TODO replace with FunctionController\n    var button = document.createElement('span');\n    button.innerHTML = 'Save';\n    dom.addClass(button, 'button');\n    dom.addClass(button, 'save');\n\n    var button2 = document.createElement('span');\n    button2.innerHTML = 'New';\n    dom.addClass(button2, 'button');\n    dom.addClass(button2, 'save-as');\n\n    var button3 = document.createElement('span');\n    button3.innerHTML = 'Revert';\n    dom.addClass(button3, 'button');\n    dom.addClass(button3, 'revert');\n\n    var select = gui.__preset_select = document.createElement('select');\n\n    if (gui.load && gui.load.remembered) {\n\n      common.each(gui.load.remembered, function(value, key) {\n        addPresetOption(gui, key, key == gui.preset);\n      });\n\n    } else {\n      addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);\n    }\n\n    dom.bind(select, 'change', function() {\n\n\n      for (var index = 0; index < gui.__preset_select.length; index++) {\n        gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;\n      }\n\n      gui.preset = this.value;\n\n    });\n\n    div.appendChild(select);\n    div.appendChild(gears);\n    div.appendChild(button);\n    div.appendChild(button2);\n    div.appendChild(button3);\n\n    if (SUPPORTS_LOCAL_STORAGE) {\n\n      var saveLocally = document.getElementById('dg-save-locally');\n      var explain = document.getElementById('dg-local-explain');\n\n      saveLocally.style.display = 'block';\n\n      var localStorageCheckBox = document.getElementById('dg-local-storage');\n\n      if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {\n        localStorageCheckBox.setAttribute('checked', 'checked');\n      }\n\n      function showHideExplain() {\n        explain.style.display = gui.useLocalStorage ? 'block' : 'none';\n      }\n\n      showHideExplain();\n\n      // TODO: Use a boolean controller, fool!\n      dom.bind(localStorageCheckBox, 'change', function() {\n        gui.useLocalStorage = !gui.useLocalStorage;\n        showHideExplain();\n      });\n\n    }\n\n    var newConstructorTextArea = document.getElementById('dg-new-constructor');\n\n    dom.bind(newConstructorTextArea, 'keydown', function(e) {\n      if (e.metaKey && (e.which === 67 || e.keyCode == 67)) {\n        SAVE_DIALOGUE.hide();\n      }\n    });\n\n    dom.bind(gears, 'click', function() {\n      newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);\n      SAVE_DIALOGUE.show();\n      newConstructorTextArea.focus();\n      newConstructorTextArea.select();\n    });\n\n    dom.bind(button, 'click', function() {\n      gui.save();\n    });\n\n    dom.bind(button2, 'click', function() {\n      var presetName = prompt('Enter a new preset name.');\n      if (presetName) gui.saveAs(presetName);\n    });\n\n    dom.bind(button3, 'click', function() {\n      gui.revert();\n    });\n\n//    div.appendChild(button2);\n\n  }\n\n  function addResizeHandle(gui) {\n\n    gui.__resize_handle = document.createElement('div');\n\n    common.extend(gui.__resize_handle.style, {\n\n      width: '6px',\n      marginLeft: '-3px',\n      height: '200px',\n      cursor: 'ew-resize',\n      position: 'absolute'\n//      border: '1px solid blue'\n\n    });\n\n    var pmouseX;\n\n    dom.bind(gui.__resize_handle, 'mousedown', dragStart);\n    dom.bind(gui.__closeButton, 'mousedown', dragStart);\n\n    gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);\n\n    function dragStart(e) {\n\n      e.preventDefault();\n\n      pmouseX = e.clientX;\n\n      dom.addClass(gui.__closeButton, GUI.CLASS_DRAG);\n      dom.bind(window, 'mousemove', drag);\n      dom.bind(window, 'mouseup', dragStop);\n\n      return false;\n\n    }\n\n    function drag(e) {\n\n      e.preventDefault();\n\n      gui.width += pmouseX - e.clientX;\n      gui.onResize();\n      pmouseX = e.clientX;\n\n      return false;\n\n    }\n\n    function dragStop() {\n\n      dom.removeClass(gui.__closeButton, GUI.CLASS_DRAG);\n      dom.unbind(window, 'mousemove', drag);\n      dom.unbind(window, 'mouseup', dragStop);\n\n    }\n\n  }\n\n  function setWidth(gui, w) {\n    gui.domElement.style.width = w + 'px';\n    // Auto placed save-rows are position fixed, so we have to\n    // set the width manually if we want it to bleed to the edge\n    if (gui.__save_row && gui.autoPlace) {\n      gui.__save_row.style.width = w + 'px';\n    }if (gui.__closeButton) {\n      gui.__closeButton.style.width = w + 'px';\n    }\n  }\n\n  function getCurrentPreset(gui, useInitialValues) {\n\n    var toReturn = {};\n\n    // For each object I'm remembering\n    common.each(gui.__rememberedObjects, function(val, index) {\n\n      var saved_values = {};\n\n      // The controllers I've made for thcommon.isObject by property\n      var controller_map =\n          gui.__rememberedObjectIndecesToControllers[index];\n\n      // Remember each value for each property\n      common.each(controller_map, function(controller, property) {\n        saved_values[property] = useInitialValues ? controller.initialValue : controller.getValue();\n      });\n\n      // Save the values for thcommon.isObject\n      toReturn[index] = saved_values;\n\n    });\n\n    return toReturn;\n\n  }\n\n  function addPresetOption(gui, name, setSelected) {\n    var opt = document.createElement('option');\n    opt.innerHTML = name;\n    opt.value = name;\n    gui.__preset_select.appendChild(opt);\n    if (setSelected) {\n      gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;\n    }\n  }\n\n  function setPresetSelectIndex(gui) {\n    for (var index = 0; index < gui.__preset_select.length; index++) {\n      if (gui.__preset_select[index].value == gui.preset) {\n        gui.__preset_select.selectedIndex = index;\n      }\n    }\n  }\n\n  function markPresetModified(gui, modified) {\n    var opt = gui.__preset_select[gui.__preset_select.selectedIndex];\n//    console.log('mark', modified, opt);\n    if (modified) {\n      opt.innerHTML = opt.value + \"*\";\n    } else {\n      opt.innerHTML = opt.value;\n    }\n  }\n\n  function updateDisplays(controllerArray) {\n\n\n    if (controllerArray.length != 0) {\n\n      requestAnimationFrame(function() {\n        updateDisplays(controllerArray);\n      });\n\n    }\n\n    common.each(controllerArray, function(c) {\n      c.updateDisplay();\n    });\n\n  }\n\n  return GUI;\n\n})(dat.utils.css,\n\"<div id=\\\"dg-save\\\" class=\\\"dg dialogue\\\">\\n\\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\\n\\n  <textarea id=\\\"dg-new-constructor\\\"></textarea>\\n\\n  <div id=\\\"dg-save-locally\\\">\\n\\n    <input id=\\\"dg-local-storage\\\" type=\\\"checkbox\\\"/> Automatically save\\n    values to <code>localStorage</code> on exit.\\n\\n    <div id=\\\"dg-local-explain\\\">The values saved to <code>localStorage</code> will\\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\\n      easier to work incrementally, but <code>localStorage</code> is fragile,\\n      and your friends may not see the same values you do.\\n      \\n    </div>\\n    \\n  </div>\\n\\n</div>\",\n\".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\\n\",\ndat.controllers.factory = (function (OptionController, NumberControllerBox, NumberControllerSlider, StringController, FunctionController, BooleanController, common) {\n\n      return function(object, property) {\n\n        var initialValue = object[property];\n\n        // Providing options?\n        if (common.isArray(arguments[2]) || common.isObject(arguments[2])) {\n          return new OptionController(object, property, arguments[2]);\n        }\n\n        // Providing a map?\n\n        if (common.isNumber(initialValue)) {\n\n          if (common.isNumber(arguments[2]) && common.isNumber(arguments[3])) {\n\n            // Has min and max.\n            return new NumberControllerSlider(object, property, arguments[2], arguments[3]);\n\n          } else {\n\n            return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3] });\n\n          }\n\n        }\n\n        if (common.isString(initialValue)) {\n          return new StringController(object, property);\n        }\n\n        if (common.isFunction(initialValue)) {\n          return new FunctionController(object, property, '');\n        }\n\n        if (common.isBoolean(initialValue)) {\n          return new BooleanController(object, property);\n        }\n\n      }\n\n    })(dat.controllers.OptionController,\ndat.controllers.NumberControllerBox,\ndat.controllers.NumberControllerSlider,\ndat.controllers.StringController = (function (Controller, dom, common) {\n\n  /**\n   * @class Provides a text input to alter the string property of an object.\n   *\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   *\n   * @member dat.controllers\n   */\n  var StringController = function(object, property) {\n\n    StringController.superclass.call(this, object, property);\n\n    var _this = this;\n\n    this.__input = document.createElement('input');\n    this.__input.setAttribute('type', 'text');\n\n    dom.bind(this.__input, 'keyup', onChange);\n    dom.bind(this.__input, 'change', onChange);\n    dom.bind(this.__input, 'blur', onBlur);\n    dom.bind(this.__input, 'keydown', function(e) {\n      if (e.keyCode === 13) {\n        this.blur();\n      }\n    });\n    \n\n    function onChange() {\n      _this.setValue(_this.__input.value);\n    }\n\n    function onBlur() {\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    this.updateDisplay();\n\n    this.domElement.appendChild(this.__input);\n\n  };\n\n  StringController.superclass = Controller;\n\n  common.extend(\n\n      StringController.prototype,\n      Controller.prototype,\n\n      {\n\n        updateDisplay: function() {\n          // Stops the caret from moving on account of:\n          // keyup -> setValue -> updateDisplay\n          if (!dom.isActive(this.__input)) {\n            this.__input.value = this.getValue();\n          }\n          return StringController.superclass.prototype.updateDisplay.call(this);\n        }\n\n      }\n\n  );\n\n  return StringController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.utils.common),\ndat.controllers.FunctionController,\ndat.controllers.BooleanController,\ndat.utils.common),\ndat.controllers.Controller,\ndat.controllers.BooleanController,\ndat.controllers.FunctionController,\ndat.controllers.NumberControllerBox,\ndat.controllers.NumberControllerSlider,\ndat.controllers.OptionController,\ndat.controllers.ColorController = (function (Controller, dom, Color, interpret, common) {\n\n  var ColorController = function(object, property) {\n\n    ColorController.superclass.call(this, object, property);\n\n    this.__color = new Color(this.getValue());\n    this.__temp = new Color(0);\n\n    var _this = this;\n\n    this.domElement = document.createElement('div');\n\n    dom.makeSelectable(this.domElement, false);\n\n    this.__selector = document.createElement('div');\n    this.__selector.className = 'selector';\n\n    this.__saturation_field = document.createElement('div');\n    this.__saturation_field.className = 'saturation-field';\n\n    this.__field_knob = document.createElement('div');\n    this.__field_knob.className = 'field-knob';\n    this.__field_knob_border = '2px solid ';\n\n    this.__hue_knob = document.createElement('div');\n    this.__hue_knob.className = 'hue-knob';\n\n    this.__hue_field = document.createElement('div');\n    this.__hue_field.className = 'hue-field';\n\n    this.__input = document.createElement('input');\n    this.__input.type = 'text';\n    this.__input_textShadow = '0 1px 1px ';\n\n    dom.bind(this.__input, 'keydown', function(e) {\n      if (e.keyCode === 13) { // on enter\n        onBlur.call(this);\n      }\n    });\n\n    dom.bind(this.__input, 'blur', onBlur);\n\n    dom.bind(this.__selector, 'mousedown', function(e) {\n\n      dom\n        .addClass(this, 'drag')\n        .bind(window, 'mouseup', function(e) {\n          dom.removeClass(_this.__selector, 'drag');\n        });\n\n    });\n\n    var value_field = document.createElement('div');\n\n    common.extend(this.__selector.style, {\n      width: '122px',\n      height: '102px',\n      padding: '3px',\n      backgroundColor: '#222',\n      boxShadow: '0px 1px 3px rgba(0,0,0,0.3)'\n    });\n\n    common.extend(this.__field_knob.style, {\n      position: 'absolute',\n      width: '12px',\n      height: '12px',\n      border: this.__field_knob_border + (this.__color.v < .5 ? '#fff' : '#000'),\n      boxShadow: '0px 1px 3px rgba(0,0,0,0.5)',\n      borderRadius: '12px',\n      zIndex: 1\n    });\n    \n    common.extend(this.__hue_knob.style, {\n      position: 'absolute',\n      width: '15px',\n      height: '2px',\n      borderRight: '4px solid #fff',\n      zIndex: 1\n    });\n\n    common.extend(this.__saturation_field.style, {\n      width: '100px',\n      height: '100px',\n      border: '1px solid #555',\n      marginRight: '3px',\n      display: 'inline-block',\n      cursor: 'pointer'\n    });\n\n    common.extend(value_field.style, {\n      width: '100%',\n      height: '100%',\n      background: 'none'\n    });\n    \n    linearGradient(value_field, 'top', 'rgba(0,0,0,0)', '#000');\n\n    common.extend(this.__hue_field.style, {\n      width: '15px',\n      height: '100px',\n      display: 'inline-block',\n      border: '1px solid #555',\n      cursor: 'ns-resize'\n    });\n\n    hueGradient(this.__hue_field);\n\n    common.extend(this.__input.style, {\n      outline: 'none',\n//      width: '120px',\n      textAlign: 'center',\n//      padding: '4px',\n//      marginBottom: '6px',\n      color: '#fff',\n      border: 0,\n      fontWeight: 'bold',\n      textShadow: this.__input_textShadow + 'rgba(0,0,0,0.7)'\n    });\n\n    dom.bind(this.__saturation_field, 'mousedown', fieldDown);\n    dom.bind(this.__field_knob, 'mousedown', fieldDown);\n\n    dom.bind(this.__hue_field, 'mousedown', function(e) {\n      setH(e);\n      dom.bind(window, 'mousemove', setH);\n      dom.bind(window, 'mouseup', unbindH);\n    });\n\n    function fieldDown(e) {\n      setSV(e);\n      // document.body.style.cursor = 'none';\n      dom.bind(window, 'mousemove', setSV);\n      dom.bind(window, 'mouseup', unbindSV);\n    }\n\n    function unbindSV() {\n      dom.unbind(window, 'mousemove', setSV);\n      dom.unbind(window, 'mouseup', unbindSV);\n      // document.body.style.cursor = 'default';\n    }\n\n    function onBlur() {\n      var i = interpret(this.value);\n      if (i !== false) {\n        _this.__color.__state = i;\n        _this.setValue(_this.__color.toOriginal());\n      } else {\n        this.value = _this.__color.toString();\n      }\n    }\n\n    function unbindH() {\n      dom.unbind(window, 'mousemove', setH);\n      dom.unbind(window, 'mouseup', unbindH);\n    }\n\n    this.__saturation_field.appendChild(value_field);\n    this.__selector.appendChild(this.__field_knob);\n    this.__selector.appendChild(this.__saturation_field);\n    this.__selector.appendChild(this.__hue_field);\n    this.__hue_field.appendChild(this.__hue_knob);\n\n    this.domElement.appendChild(this.__input);\n    this.domElement.appendChild(this.__selector);\n\n    this.updateDisplay();\n\n    function setSV(e) {\n\n      e.preventDefault();\n\n      var w = dom.getWidth(_this.__saturation_field);\n      var o = dom.getOffset(_this.__saturation_field);\n      var s = (e.clientX - o.left + document.body.scrollLeft) / w;\n      var v = 1 - (e.clientY - o.top + document.body.scrollTop) / w;\n\n      if (v > 1) v = 1;\n      else if (v < 0) v = 0;\n\n      if (s > 1) s = 1;\n      else if (s < 0) s = 0;\n\n      _this.__color.v = v;\n      _this.__color.s = s;\n\n      _this.setValue(_this.__color.toOriginal());\n\n\n      return false;\n\n    }\n\n    function setH(e) {\n\n      e.preventDefault();\n\n      var s = dom.getHeight(_this.__hue_field);\n      var o = dom.getOffset(_this.__hue_field);\n      var h = 1 - (e.clientY - o.top + document.body.scrollTop) / s;\n\n      if (h > 1) h = 1;\n      else if (h < 0) h = 0;\n\n      _this.__color.h = h * 360;\n\n      _this.setValue(_this.__color.toOriginal());\n\n      return false;\n\n    }\n\n  };\n\n  ColorController.superclass = Controller;\n\n  common.extend(\n\n      ColorController.prototype,\n      Controller.prototype,\n\n      {\n\n        updateDisplay: function() {\n\n          var i = interpret(this.getValue());\n\n          if (i !== false) {\n\n            var mismatch = false;\n\n            // Check for mismatch on the interpreted value.\n\n            common.each(Color.COMPONENTS, function(component) {\n              if (!common.isUndefined(i[component]) &&\n                  !common.isUndefined(this.__color.__state[component]) &&\n                  i[component] !== this.__color.__state[component]) {\n                mismatch = true;\n                return {}; // break\n              }\n            }, this);\n\n            // If nothing diverges, we keep our previous values\n            // for statefulness, otherwise we recalculate fresh\n            if (mismatch) {\n              common.extend(this.__color.__state, i);\n            }\n\n          }\n\n          common.extend(this.__temp.__state, this.__color.__state);\n\n          this.__temp.a = 1;\n\n          var flip = (this.__color.v < .5 || this.__color.s > .5) ? 255 : 0;\n          var _flip = 255 - flip;\n\n          common.extend(this.__field_knob.style, {\n            marginLeft: 100 * this.__color.s - 7 + 'px',\n            marginTop: 100 * (1 - this.__color.v) - 7 + 'px',\n            backgroundColor: this.__temp.toString(),\n            border: this.__field_knob_border + 'rgb(' + flip + ',' + flip + ',' + flip +')'\n          });\n\n          this.__hue_knob.style.marginTop = (1 - this.__color.h / 360) * 100 + 'px'\n\n          this.__temp.s = 1;\n          this.__temp.v = 1;\n\n          linearGradient(this.__saturation_field, 'left', '#fff', this.__temp.toString());\n\n          common.extend(this.__input.style, {\n            backgroundColor: this.__input.value = this.__color.toString(),\n            color: 'rgb(' + flip + ',' + flip + ',' + flip +')',\n            textShadow: this.__input_textShadow + 'rgba(' + _flip + ',' + _flip + ',' + _flip +',.7)'\n          });\n\n        }\n\n      }\n\n  );\n  \n  var vendors = ['-moz-','-o-','-webkit-','-ms-',''];\n  \n  function linearGradient(elem, x, a, b) {\n    elem.style.background = '';\n    common.each(vendors, function(vendor) {\n      elem.style.cssText += 'background: ' + vendor + 'linear-gradient('+x+', '+a+' 0%, ' + b + ' 100%); ';\n    });\n  }\n  \n  function hueGradient(elem) {\n    elem.style.background = '';\n    elem.style.cssText += 'background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);'\n    elem.style.cssText += 'background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);'\n    elem.style.cssText += 'background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);'\n    elem.style.cssText += 'background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);'\n    elem.style.cssText += 'background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);'\n  }\n\n\n  return ColorController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.color.Color = (function (interpret, math, toString, common) {\n\n  var Color = function() {\n\n    this.__state = interpret.apply(this, arguments);\n\n    if (this.__state === false) {\n      throw 'Failed to interpret color arguments';\n    }\n\n    this.__state.a = this.__state.a || 1;\n\n\n  };\n\n  Color.COMPONENTS = ['r','g','b','h','s','v','hex','a'];\n\n  common.extend(Color.prototype, {\n\n    toString: function() {\n      return toString(this);\n    },\n\n    toOriginal: function() {\n      return this.__state.conversion.write(this);\n    }\n\n  });\n\n  defineRGBComponent(Color.prototype, 'r', 2);\n  defineRGBComponent(Color.prototype, 'g', 1);\n  defineRGBComponent(Color.prototype, 'b', 0);\n\n  defineHSVComponent(Color.prototype, 'h');\n  defineHSVComponent(Color.prototype, 's');\n  defineHSVComponent(Color.prototype, 'v');\n\n  Object.defineProperty(Color.prototype, 'a', {\n\n    get: function() {\n      return this.__state.a;\n    },\n\n    set: function(v) {\n      this.__state.a = v;\n    }\n\n  });\n\n  Object.defineProperty(Color.prototype, 'hex', {\n\n    get: function() {\n\n      if (!this.__state.space !== 'HEX') {\n        this.__state.hex = math.rgb_to_hex(this.r, this.g, this.b);\n      }\n\n      return this.__state.hex;\n\n    },\n\n    set: function(v) {\n\n      this.__state.space = 'HEX';\n      this.__state.hex = v;\n\n    }\n\n  });\n\n  function defineRGBComponent(target, component, componentHexIndex) {\n\n    Object.defineProperty(target, component, {\n\n      get: function() {\n\n        if (this.__state.space === 'RGB') {\n          return this.__state[component];\n        }\n\n        recalculateRGB(this, component, componentHexIndex);\n\n        return this.__state[component];\n\n      },\n\n      set: function(v) {\n\n        if (this.__state.space !== 'RGB') {\n          recalculateRGB(this, component, componentHexIndex);\n          this.__state.space = 'RGB';\n        }\n\n        this.__state[component] = v;\n\n      }\n\n    });\n\n  }\n\n  function defineHSVComponent(target, component) {\n\n    Object.defineProperty(target, component, {\n\n      get: function() {\n\n        if (this.__state.space === 'HSV')\n          return this.__state[component];\n\n        recalculateHSV(this);\n\n        return this.__state[component];\n\n      },\n\n      set: function(v) {\n\n        if (this.__state.space !== 'HSV') {\n          recalculateHSV(this);\n          this.__state.space = 'HSV';\n        }\n\n        this.__state[component] = v;\n\n      }\n\n    });\n\n  }\n\n  function recalculateRGB(color, component, componentHexIndex) {\n\n    if (color.__state.space === 'HEX') {\n\n      color.__state[component] = math.component_from_hex(color.__state.hex, componentHexIndex);\n\n    } else if (color.__state.space === 'HSV') {\n\n      common.extend(color.__state, math.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\n\n    } else {\n\n      throw 'Corrupted color state';\n\n    }\n\n  }\n\n  function recalculateHSV(color) {\n\n    var result = math.rgb_to_hsv(color.r, color.g, color.b);\n\n    common.extend(color.__state,\n        {\n          s: result.s,\n          v: result.v\n        }\n    );\n\n    if (!common.isNaN(result.h)) {\n      color.__state.h = result.h;\n    } else if (common.isUndefined(color.__state.h)) {\n      color.__state.h = 0;\n    }\n\n  }\n\n  return Color;\n\n})(dat.color.interpret,\ndat.color.math = (function () {\n\n  var tmpComponent;\n\n  return {\n\n    hsv_to_rgb: function(h, s, v) {\n\n      var hi = Math.floor(h / 60) % 6;\n\n      var f = h / 60 - Math.floor(h / 60);\n      var p = v * (1.0 - s);\n      var q = v * (1.0 - (f * s));\n      var t = v * (1.0 - ((1.0 - f) * s));\n      var c = [\n        [v, t, p],\n        [q, v, p],\n        [p, v, t],\n        [p, q, v],\n        [t, p, v],\n        [v, p, q]\n      ][hi];\n\n      return {\n        r: c[0] * 255,\n        g: c[1] * 255,\n        b: c[2] * 255\n      };\n\n    },\n\n    rgb_to_hsv: function(r, g, b) {\n\n      var min = Math.min(r, g, b),\n          max = Math.max(r, g, b),\n          delta = max - min,\n          h, s;\n\n      if (max != 0) {\n        s = delta / max;\n      } else {\n        return {\n          h: NaN,\n          s: 0,\n          v: 0\n        };\n      }\n\n      if (r == max) {\n        h = (g - b) / delta;\n      } else if (g == max) {\n        h = 2 + (b - r) / delta;\n      } else {\n        h = 4 + (r - g) / delta;\n      }\n      h /= 6;\n      if (h < 0) {\n        h += 1;\n      }\n\n      return {\n        h: h * 360,\n        s: s,\n        v: max / 255\n      };\n    },\n\n    rgb_to_hex: function(r, g, b) {\n      var hex = this.hex_with_component(0, 2, r);\n      hex = this.hex_with_component(hex, 1, g);\n      hex = this.hex_with_component(hex, 0, b);\n      return hex;\n    },\n\n    component_from_hex: function(hex, componentIndex) {\n      return (hex >> (componentIndex * 8)) & 0xFF;\n    },\n\n    hex_with_component: function(hex, componentIndex, value) {\n      return value << (tmpComponent = componentIndex * 8) | (hex & ~ (0xFF << tmpComponent));\n    }\n\n  }\n\n})(),\ndat.color.toString,\ndat.utils.common),\ndat.color.interpret,\ndat.utils.common),\ndat.utils.requestAnimationFrame = (function () {\n\n  /**\n   * requirejs version of Paul Irish's RequestAnimationFrame\n   * http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n   */\n\n  return window.webkitRequestAnimationFrame ||\n      window.mozRequestAnimationFrame ||\n      window.oRequestAnimationFrame ||\n      window.msRequestAnimationFrame ||\n      function(callback, element) {\n\n        window.setTimeout(callback, 1000 / 60);\n\n      };\n})(),\ndat.dom.CenteredDiv = (function (dom, common) {\n\n\n  var CenteredDiv = function() {\n\n    this.backgroundElement = document.createElement('div');\n    common.extend(this.backgroundElement.style, {\n      backgroundColor: 'rgba(0,0,0,0.8)',\n      top: 0,\n      left: 0,\n      display: 'none',\n      zIndex: '1000',\n      opacity: 0,\n      WebkitTransition: 'opacity 0.2s linear'\n    });\n\n    dom.makeFullscreen(this.backgroundElement);\n    this.backgroundElement.style.position = 'fixed';\n\n    this.domElement = document.createElement('div');\n    common.extend(this.domElement.style, {\n      position: 'fixed',\n      display: 'none',\n      zIndex: '1001',\n      opacity: 0,\n      WebkitTransition: '-webkit-transform 0.2s ease-out, opacity 0.2s linear'\n    });\n\n\n    document.body.appendChild(this.backgroundElement);\n    document.body.appendChild(this.domElement);\n\n    var _this = this;\n    dom.bind(this.backgroundElement, 'click', function() {\n      _this.hide();\n    });\n\n\n  };\n\n  CenteredDiv.prototype.show = function() {\n\n    var _this = this;\n    \n\n\n    this.backgroundElement.style.display = 'block';\n\n    this.domElement.style.display = 'block';\n    this.domElement.style.opacity = 0;\n//    this.domElement.style.top = '52%';\n    this.domElement.style.webkitTransform = 'scale(1.1)';\n\n    this.layout();\n\n    common.defer(function() {\n      _this.backgroundElement.style.opacity = 1;\n      _this.domElement.style.opacity = 1;\n      _this.domElement.style.webkitTransform = 'scale(1)';\n    });\n\n  };\n\n  CenteredDiv.prototype.hide = function() {\n\n    var _this = this;\n\n    var hide = function() {\n\n      _this.domElement.style.display = 'none';\n      _this.backgroundElement.style.display = 'none';\n\n      dom.unbind(_this.domElement, 'webkitTransitionEnd', hide);\n      dom.unbind(_this.domElement, 'transitionend', hide);\n      dom.unbind(_this.domElement, 'oTransitionEnd', hide);\n\n    };\n\n    dom.bind(this.domElement, 'webkitTransitionEnd', hide);\n    dom.bind(this.domElement, 'transitionend', hide);\n    dom.bind(this.domElement, 'oTransitionEnd', hide);\n\n    this.backgroundElement.style.opacity = 0;\n//    this.domElement.style.top = '48%';\n    this.domElement.style.opacity = 0;\n    this.domElement.style.webkitTransform = 'scale(1.1)';\n\n  };\n\n  CenteredDiv.prototype.layout = function() {\n    this.domElement.style.left = window.innerWidth/2 - dom.getWidth(this.domElement) / 2 + 'px';\n    this.domElement.style.top = window.innerHeight/2 - dom.getHeight(this.domElement) / 2 + 'px';\n  };\n  \n  function lockScroll(e) {\n    console.log(e);\n  }\n\n  return CenteredDiv;\n\n})(dat.dom.dom,\ndat.utils.common),\ndat.dom.dom,\ndat.utils.common);"]}